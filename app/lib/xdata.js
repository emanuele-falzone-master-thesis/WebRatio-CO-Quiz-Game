(function(GLOBAL,undefined,define){if(GLOBAL["xdata"]){return};;(function(){"use strict";'use strict';var DEBUG=false;var FILE_NAME="xdata.js";var FILE_VERSION="0.9.3.201807181403";var exportSymbol=function(publicPath,object,objectToExportTo){_exportPath(publicPath,object,objectToExportTo)};var _exportPath=function(name$$35,object$$1,objectToExportTo$$1){var parts=name$$35.split(".");var cur=objectToExportTo$$1||GLOBAL;var part;for(;parts.length&&(part=parts.shift());)if(!parts.length&&object$$1!==undefined)cur[part]=object$$1;else if(cur[part])cur=cur[part];else cur=cur[part]={}};var exportProperty=function(object$$2,publicName,symbol$$1){object$$2[publicName]=symbol$$1};var EMPTY_FUNCTION=function(){};var ABSTRACT_METHOD=function(){throw new Error("Unimplemented abstract method");};var newObject=function(proto$$3,properties){var o;if(proto$$3){var ctor=function(){};ctor.prototype=proto$$3;o=new ctor}else o={};if(properties){var p;for(p in properties)if(properties.hasOwnProperty(p))o[p]=properties[p]}return o};
var _extendConstructor=function(derived,base$$1){derived._super=base$$1.prototype;derived.prototype=newObject(base$$1.prototype);derived.prototype["constructor"]=derived};var extendConstructor=_extendConstructor;var extendFunctionPrototype=_extendConstructor;
var makeCustomErrorConstructor=function(name$$36,base$$2,constructor){base$$2=base$$2||GLOBAL["Error"];var ctor$$1=function(){var tmp=null;this._super=function(){tmp=base$$2.apply(this,arguments)};if(constructor)constructor.apply(this,arguments);if(!tmp)this._super.apply(this,arguments);delete this._super;this.name=name$$36;this.message=tmp.message||name$$36;if(typeof Error["captureStackTrace"]==="function")Error["captureStackTrace"](tmp,ctor$$1);if(tmp.stack!==undefined)this.stack=tmp.stack};_extendConstructor(ctor$$1,
base$$2);return ctor$$1};var xdata={};xdata.CollectionOperator={ALL:"all",ANY:"any"};exportSymbol("xdata.CollectionOperator",xdata.CollectionOperator);xdata.Query=function(){};exportSymbol("xdata.Query",xdata.Query);xdata.Query.prototype.addChangeTracker=function(changeTracker){};exportProperty(xdata.Query.prototype,"addChangeTracker",xdata.Query.prototype.addChangeTracker);xdata.Query.prototype.removeChangeTracker=function(changeTracker$$1){};exportProperty(xdata.Query.prototype,"removeChangeTracker",xdata.Query.prototype.removeChangeTracker);xdata.Query.prototype.clearChangeTrackers=function(){};
exportProperty(xdata.Query.prototype,"clearChangeTrackers",xdata.Query.prototype.clearChangeTrackers);xdata.Query.ChangeTracker=function(){};exportProperty(xdata.Query,"ChangeTracker",xdata.Query.ChangeTracker);xdata.Query.ChangeTracker.prototype.tracked;exportProperty(xdata.Query.ChangeTracker.prototype,"tracked",xdata.Query.ChangeTracker.prototype.tracked);xdata.Query.ChangeTracker.prototype.trackedOld;exportProperty(xdata.Query.ChangeTracker.prototype,"trackedOld",xdata.Query.ChangeTracker.prototype.trackedOld);
xdata.Query.ChangeTracker.prototype.afterInsert=function(values){};exportProperty(xdata.Query.ChangeTracker.prototype,"afterInsert",xdata.Query.ChangeTracker.prototype.afterInsert);xdata.Query.ChangeTracker.prototype.afterUpdate=function(values$$1,valuesOld){};exportProperty(xdata.Query.ChangeTracker.prototype,"afterUpdate",xdata.Query.ChangeTracker.prototype.afterUpdate);xdata.Query.ChangeTracker.prototype.afterDelete=function(values$$2){};
exportProperty(xdata.Query.ChangeTracker.prototype,"afterDelete",xdata.Query.ChangeTracker.prototype.afterDelete);xdata.util={};xdata.util.isObject=function(value$$53){return!!value$$53&&typeof value$$53==="object"};xdata.util.isPromise=function(value$$54){return typeof value$$54==="object"&&!!value$$54&&"then"in value$$54};xdata.util.construct=function(ctor$$2,args){var instance=Object.create(ctor$$2.prototype);ctor$$2.apply(instance,Array.prototype.slice.call(arguments,1));return instance};
xdata.util.forEachOfObject=function(object$$3,callback$$21,thisArg$$1){Object.keys(object$$3).forEach(function(key$$3){var value$$55=object$$3[key$$3];callback$$21.call(thisArg$$1,value$$55,key$$3)})};
xdata.util.assignObject=function(target$$26,var_args$$43){if(target$$26===undefined||target$$26===null)throw new TypeError("Cannot convert first argument to object");target$$26=Object(target$$26);var i$$3=1;for(;i$$3<arguments.length;i$$3++){var source$$10=arguments[i$$3];if(source$$10===undefined||source$$10===null)continue;source$$10=Object(source$$10);var key$$4;for(key$$4 in source$$10){if(!source$$10.hasOwnProperty(key$$4))continue;target$$26[key$$4]=source$$10[key$$4]}}return target$$26};
xdata.util.mapObject=function(object$$4,valueMapper,keyMapper,thisArg$$2){var result={};xdata.util.forEachOfObject(object$$4,function(value$$56,key$$5){if(valueMapper)value$$56=valueMapper.call(thisArg$$2,value$$56,key$$5);if(keyMapper)key$$5=keyMapper.call(thisArg$$2,key$$5);result[key$$5]=value$$56},thisArg$$2);return result};
xdata.util.mapObjectToArray=function(object$$5,mapper,thisArg$$3){var result$$1=[];xdata.util.forEachOfObject(object$$5,function(value$$57,key$$6){result$$1.push(mapper.call(thisArg$$3,value$$57,key$$6))},thisArg$$3);return result$$1};xdata.util.extractValues=function(object$$6){return Object.keys(object$$6).map(function(key$$7){return object$$6[key$$7]})};
xdata.util.computeHashCode=function(){function oflw32(n$$3){return n$$3&4294967295}function computeStringHashCode(s$$1){var hashCode=0;var i$$4=0;for(;i$$4<s$$1.length;i$$4++)hashCode=oflw32(oflw32(31*hashCode)+s$$1.charCodeAt(i$$4));return hashCode}function computeArrayHash(arr$$8){var result$$2=0;var i$$5=0;for(;i$$5<arr$$8.length;i$$5++)result$$2=result$$2^computeValueHashCode(arr$$8[i$$5]);return result$$2}function computeObjectHash(obj$$22){var result$$3=0;var key$$8;for(key$$8 in obj$$22)if(hasOwnProperty$$1.call(obj$$22,
key$$8))result$$3=result$$3^computeValueHashCode(obj$$22[key$$8]);return result$$3}function computeValueHashCode(value$$58){var type$$65=typeof value$$58;switch(type$$65){case "object":if(value$$58===null)return 0;if(isArray(value$$58))return computeArrayHash(value$$58);return computeObjectHash(value$$58);case "undefined":return 0;case "boolean":return value$$58?1231:1237;case "number":return oflw32(value$$58);case "string":return computeStringHashCode(value$$58);case "symbol":case "function":default:throw new Error("Cannot hash values of type "+
type$$65);}}var hasOwnProperty$$1=Object.prototype.hasOwnProperty;var isArray=Array.isArray;return computeValueHashCode}();
xdata.util.equal=function(){function computeArrayEquality(arr1,arr2){if(arr1.length!==arr2.length)return false;var i$$6=0;for(;i$$6<arr1.length;i$$6++)if(!computeValueEquality(arr1[i$$6],arr2[i$$6]))return false;return true}function computeObjectEquality(obj1,obj2){var foundKeys1=Object.create(null);var key$$9;for(key$$9 in obj1){if(!hasOwnProperty$$2.call(obj1,key$$9))continue;foundKeys1[key$$9]=true;if(hasOwnProperty$$2.call(obj2,key$$9)){if(!computeValueEquality(obj1[key$$9],obj2[key$$9]))return false}else return false}for(key$$9 in obj2){if(!hasOwnProperty$$2.call(obj2,
key$$9))continue;if(foundKeys1[key$$9]!==true)return false}return true}function computeValueEquality(value1$$2,value2$$1){if(value1$$2===value2$$1)return true;if((value1$$2===null||value2$$1===null)&&(value1$$2===undefined||value2$$1===undefined))return false;if(typeof value1$$2==="object"&&typeof value2$$1==="object"){if(isArray$$1(value1$$2)){if(isArray$$1(value2$$1))return computeArrayEquality(value1$$2,value2$$1);return false}return computeObjectEquality(value1$$2,value2$$1)}return false}var hasOwnProperty$$2=
Object.prototype.hasOwnProperty;var isArray$$1=Array.isArray;return computeValueEquality}();xdata.util._EnumInfo;xdata.util._getEnumTypeInfo=function(enumType){var info=enumType["_enum_type_info"];if(!info){info={names:[],values:[],namesByValue:{}};xdata.util.forEachOfObject(enumType,function(value$$59,name$$37){if(typeof value$$59==="function")return;info.names.push(name$$37);info.values.push(value$$59);info.namesByValue[value$$59]=name$$37});Object.defineProperty(enumType,"_enum_type_info",{value:info})}return info};
xdata.util.getEnumValues=function(enumType$$1){return xdata.util._getEnumTypeInfo(enumType$$1).values};exportSymbol("xdata.util.getEnumValues",xdata.util.getEnumValues);xdata.util.getEnumNames=function(enumType$$2){return xdata.util._getEnumTypeInfo(enumType$$2).names};exportSymbol("xdata.util.getEnumNames",xdata.util.getEnumNames);
xdata.util.getEnumName=function(enumType$$3,value$$60){var name$$38=xdata.util._getEnumTypeInfo(enumType$$3).namesByValue[value$$60];if(!name$$38)throw new TypeError("Invalid constant value '"+value$$60+"' for enumeration type "+enumType$$3);return name$$38};exportSymbol("xdata.util.getEnumName",xdata.util.getEnumName);
xdata.util.castEnumValue=function(enumType$$4,value$$61){if(!xdata.util._getEnumTypeInfo(enumType$$4).namesByValue[value$$61])throw new TypeError("Invalid constant value '"+value$$61+"' for enumeration type "+enumType$$4);return value$$61};exportSymbol("xdata.util.castEnumValue",xdata.util.castEnumValue);xdata.util.str={};xdata.util.str.capitalize=function(s$$2){return s$$2.charAt(0).toUpperCase()+s$$2.substring(1)};xdata.core={};xdata.core.SchemaMapper=function(schema,providerName){this._schema=schema;this._providerName=providerName;this._providerSchema=null};xdata.core.SchemaMapper.prototype.getSchema=function(){return this._schema};xdata.core.SchemaMapper.prototype.getProviderSchema=function(){var providerSchema=this._providerSchema;if(!providerSchema)this._providerSchema=providerSchema=this._createSchema();return providerSchema};
xdata.core.SchemaMapper.prototype._createSchema=function(){var schema$$1=this._schema;return{stores:schema$$1.getEntities().map(this._createStoreSchema,this),relations:schema$$1.getRelationships().map(this._createRelationSchema,this),properties:this._createProviderProperties(schema$$1)}};
xdata.core.SchemaMapper.prototype._createStoreSchema=function(entity){var $jscomp$this=this;var inputSchemas=[];var inputNamesSet={};entity.getInputs().forEach(function(input){input.getFields().forEach(function(field){var inputSchema=$jscomp$this._createInputFieldSchema(field);if(inputNamesSet[inputSchema.name])throw new Error("Conflicting input field name '"+inputSchema.name+"'");inputNamesSet[inputSchema.name]=true;inputSchemas.push(inputSchema)})});var fieldSchemas=[];var fieldNamesSet={};entity.getAttributes().forEach(function(attr){attr.getFields().forEach(function(field$$1){var fieldSchema=
$jscomp$this._createAttributeFieldSchema(field$$1);if(fieldNamesSet[fieldSchema.name])throw new Error("Conflicting attribute field name '"+fieldSchema.name+"'");fieldNamesSet[fieldSchema.name]=true;fieldSchemas.push(fieldSchema)})});var indexSchemas=[];entity.getIndexes().forEach(function(index$$34){var indexSchema=$jscomp$this._createIndexSchema(index$$34);indexSchemas.push(indexSchema)});return{name:xdata.core.SchemaMapper.getStoreName(entity),identities:xdata.core.SchemaMapper.getStoreIdentities(entity),
inputs:inputSchemas,fields:fieldSchemas,indexes:indexSchemas,properties:this._createProviderProperties(entity)}};xdata.core.SchemaMapper.prototype._createInputFieldSchema=function(field$$2){return{name:xdata.core.SchemaMapper.getInputFieldName(field$$2),type:field$$2.getType(),identities:xdata.core.SchemaMapper.getInputFieldIdentities(field$$2),properties:this._createProviderProperties(field$$2)}};
xdata.core.SchemaMapper.prototype._createAttributeFieldSchema=function(field$$3){return{name:xdata.core.SchemaMapper.getAttributeFieldName(field$$3),type:field$$3.getType(),key:field$$3.getAttribute().isKey(),identities:xdata.core.SchemaMapper.getAttributeFieldIdentities(field$$3),properties:this._createProviderProperties(field$$3)}};
xdata.core.SchemaMapper.prototype._createIndexSchema=function(index$$35){return{unique:index$$35.isUnique(),fieldNames:Array.prototype.concat.apply([],index$$35.getAttributes().map(function(attr$$1){return attr$$1.getFields().map(xdata.core.SchemaMapper.getAttributeFieldName)})),properties:this._createProviderProperties(index$$35)}};
xdata.core.SchemaMapper.prototype._createRelationSchema=function(rel){return{name:xdata.core.SchemaMapper.getRelationName(rel),identities:xdata.core.SchemaMapper.getRelationIdentities(rel),end1:this._createRelationEndSchema(rel.getRole1()),end2:this._createRelationEndSchema(rel.getRole2()),properties:this._createProviderProperties(rel)}};
xdata.core.SchemaMapper.prototype._createRelationEndSchema=function(role){return{storeName:xdata.core.SchemaMapper.getStoreName(role.getEntity()),name:xdata.core.SchemaMapper.getRelationEndName(role),many:role.isManyParticipant(),innerName:xdata.core.SchemaMapper.getRelationEndInnerName(role),properties:this._createProviderProperties(role)}};xdata.core.SchemaMapper.prototype._createProviderProperties=function(element$$4){return xdata.util.assignObject({},element$$4.getProviderConfig(this._providerName))};
xdata.core.SchemaMapper.getStoreName=function(entity$$1){return entity$$1.getName()};xdata.core.SchemaMapper.getStoreIdentities=function(entity$$2){var identity=entity$$2.getIdentity();return identity?[identity]:[]};xdata.core.SchemaMapper.getInputFieldName=function(field$$4){var inputName=field$$4.getInput().getName();var fieldName=field$$4.getName();return fieldName?inputName+"_"+fieldName:inputName};
xdata.core.SchemaMapper.getInputFieldIdentities=function(field$$5){var inputIdentity=field$$5.getInput().getIdentity();if(!inputIdentity)return[];var fieldIdentity=field$$5.getIdentity()||":name:"+field$$5.getName();return[inputIdentity+"/"+fieldIdentity]};xdata.core.SchemaMapper.getAttributeFieldName=function(field$$6){var attrName=field$$6.getAttribute().getName();var fieldName$$1=field$$6.getName();return fieldName$$1?attrName+"_"+fieldName$$1:attrName};
xdata.core.SchemaMapper.getAttributeFieldIdentities=function(field$$7){var attrIdentity=field$$7.getAttribute().getIdentity();if(!attrIdentity)return[];var fieldIdentity$$1=field$$7.getIdentity()||":name:"+field$$7.getName();return[attrIdentity+"/"+fieldIdentity$$1]};xdata.core.SchemaMapper.getRelationName=function(rel$$1){return xdata.util.str.capitalize(rel$$1.getName())};
xdata.core.SchemaMapper.getRelationIdentities=function(rel$$2){var identity$$1=rel$$2.getIdentity();return identity$$1?[identity$$1]:[]};xdata.core.SchemaMapper.getRelationEndName=function(role$$1){return role$$1.getNameAtEntity()};xdata.core.SchemaMapper.getRelationEndInnerName=function(role$$2){return role$$2.getName()};xdata.core.ElementRef=function(baseElement,elements){this._baseElement=baseElement;this._elements=elements;this._mappedFieldPathPrefix=null;if(DEBUG&&elements.length<=0)throw new Error("Empty path of referenced elements");};xdata.core.ElementRef.prototype.getBaseElement=function(){return this._baseElement};xdata.core.ElementRef.prototype.getElement=function(){return this._elements[this._elements.length-1]};
xdata.core.ElementRef.prototype.getAttribute=function(){var element$$5=this.getElement();if(!(element$$5 instanceof xdata.schema.Attribute))throw new Error("Reference does not point to an attribute");return element$$5};xdata.core.ElementRef.prototype.getAttributeField=function(){var element$$6=this.getElement();if(!(element$$6 instanceof xdata.schema.AttributeField))throw new Error("Reference does not point to an attribute field");return element$$6};
xdata.core.ElementRef.prototype.computeMappedAttributeFieldPath=function(fieldName$$2){var attr$$2;var field$$8;var element$$7=this.getElement();if(element$$7 instanceof xdata.schema.AttributeField){if(element$$7.getName()!==fieldName$$2)throw new Error("Unable to reference attribute field '"+fieldName$$2+"'");attr$$2=element$$7.getAttribute();field$$8=element$$7}else{attr$$2=this.getAttribute();field$$8=attr$$2.getField(fieldName$$2)}var prefix$$2=this._mappedFieldPathPrefix;if(!prefix$$2)this._mappedFieldPathPrefix=
prefix$$2=this._computeMappedAttributeFieldPathPrefix();return prefix$$2+xdata.core.SchemaMapper.getAttributeFieldName(field$$8)};
xdata.core.ElementRef.prototype._computeMappedAttributeFieldPathPrefix=function(){var prefixLength;if(this._elements[this._elements.length-1]instanceof xdata.schema.AttributeField)prefixLength=this._elements.length-2;else prefixLength=this._elements.length-1;var result$$4="";var i$$7=0;for(;i$$7<prefixLength;i$$7++){var element$$8=this._elements[i$$7];var previousElement=i$$7>0?this._elements[i$$7-1]:this._baseElement;var mappedName;if(element$$8 instanceof xdata.schema.Role)if(previousElement instanceof
xdata.schema.Relationship)mappedName=xdata.core.SchemaMapper.getRelationEndInnerName(element$$8);else{if(DEBUG&&!(previousElement instanceof xdata.schema.Entity||previousElement instanceof xdata.schema.Role))throw new Error("Invalid previous element type");mappedName=xdata.core.SchemaMapper.getRelationEndName(element$$8)}else if(element$$8 instanceof xdata.schema.Entity)mappedName=xdata.core.SchemaMapper.getStoreName(element$$8);else throw new Error("Unexpected un-mappable element "+element$$8);result$$4=
result$$4+(mappedName+".")}return result$$4};xdata.core.ElementRef.prototype.toUniqueKey=function(){return"["+this._baseElement.getName()+"]."+this._elements.map(function(element$$9){return element$$9.getName()}).join(".")};xdata.core.ElementRef.prototype.toString=function(){return this.toUniqueKey()};
xdata.core.ElementRef.of=function(baseElement$$1,expression$$2){var names=expression$$2.split(".");var fragmentName;if(!names[0])throw new Error("Empty reference expresison '"+expression$$2+"'");var lastName=names[names.length-1];var sharpIndex=lastName.indexOf("#");if(sharpIndex>0){names[names.length-1]=lastName.substring(0,sharpIndex);fragmentName=lastName.substring(sharpIndex+1)}else fragmentName=null;var elements$$1=[];var currentBaseElement=baseElement$$1;var lastElement=null;var i$$8=0;for(;i$$8<
names.length;i$$8++){if(currentBaseElement instanceof xdata.schema.Entity){lastElement=currentBaseElement.getProperty(names[i$$8]);if(lastElement instanceof xdata.schema.Role)currentBaseElement=lastElement.getInverseEntity();else{currentBaseElement=null;if(i$$8<names.length-1)throw new Error("Found attribute not at the end of reference expression '"+expression$$2+"'");}}else{if(currentBaseElement.hasRole(names[i$$8]))lastElement=currentBaseElement.getRole(names[i$$8]);else if(currentBaseElement.hasEntity(names[i$$8]))lastElement=
currentBaseElement.getEntity(names[i$$8])===currentBaseElement.getEntity1()?currentBaseElement.getRole1():currentBaseElement.getRole2();else throw new Error("Unknown role or entity '"+names[i$$8]+"'");currentBaseElement=lastElement.getEntity()}elements$$1.push(lastElement)}if(fragmentName!==null){if(lastElement instanceof xdata.schema.Attribute)lastElement=lastElement.getField(fragmentName);else throw new Error("Found fragment not after an attribute");elements$$1.push(lastElement)}return new xdata.core.ElementRef(baseElement$$1,
elements$$1)};xdata.core.CompiledOrder=function(db$$1,baseElement$$2,orderExpr){this._db=db$$1;this._baseElement=baseElement$$2;this._providerOrderExpr=[];this._compileOrderExpr(orderExpr,this._providerOrderExpr)};
xdata.core.CompiledOrder.prototype._compileOrderExpr=function(expr$$3,providerTerms){if(Array.isArray(expr$$3))expr$$3.forEach(function(term){term=this._normalizeOrderTerm(term);this._compileOrderTerm(term.property,term.descending||false,providerTerms)},this);else{var onlyTerm=this._normalizeOrderTerm(expr$$3);this._compileOrderTerm(onlyTerm.property,onlyTerm.descending||false,providerTerms)}};
xdata.core.CompiledOrder.prototype._normalizeOrderTerm=function(term$$1){if(typeof term$$1==="string")term$$1={property:term$$1,descending:false};return term$$1};
xdata.core.CompiledOrder.prototype._compileOrderTerm=function(property$$1,descending,providerTerms$$1){var propertyRef=xdata.core.ElementRef.of(this._baseElement,property$$1);var valueAccessor=xdata.core.getValueAccessor(this._db,propertyRef);var orderMapping=valueAccessor.getOrderMapping(descending);orderMapping.forEach(function(entry){providerTerms$$1.push({fieldPath:propertyRef.computeMappedAttributeFieldPath(entry.field),descending:entry.descending})},this)};
xdata.core.CompiledOrder.prototype.getProviderExpression=function(){return this._providerOrderExpr};xdata.core.castTx=function(tx){if(DEBUG)if(!(tx instanceof xdata.core.TransactionImpl))throw new Error("Invalid transaction object");return tx};xdata.core.isEmptyValue=function(value$$62,acceptNull){return value$$62===undefined||!acceptNull&&value$$62===null||Array.isArray(value$$62)&&value$$62.length<=0};
xdata.core.getValueAccessor=function(db$$2,elementOrRef){var element$$10=elementOrRef instanceof xdata.schema.Element?elementOrRef:elementOrRef.getElement();if(element$$10 instanceof xdata.schema.Attribute)return db$$2.getAttributeValueAccessor(element$$10);else if(element$$10 instanceof xdata.schema.AttributeField)return db$$2.getAttributeValueAccessor(element$$10.getAttribute(),element$$10.getName());else if(element$$10 instanceof xdata.schema.Input)return db$$2.getInputValueAccessor(element$$10);
else if(element$$10 instanceof xdata.schema.InputField)return db$$2.getInputValueAccessor(element$$10.getInput(),element$$10.getName());throw new Error("Cannot access a value on "+element$$10);};xdata.core.createList=function(array$$10,providerMetadata){var list=array$$10;var metadata=new xdata.core.MetadataImpl(providerMetadata);list.getMetadata=function(){return metadata};return list};xdata.core._METADATA_KEY="__xdata_result_metadata";
xdata.core.embedProviderMetadata=function(providerResult,providerMetadata$$1){if(typeof providerResult==="object"&&!!providerResult)Object.defineProperty(providerResult,xdata.core._METADATA_KEY,{value:providerMetadata$$1})};xdata.core.extractProviderMetadata=function(providerResult$$1){return providerResult$$1&&providerResult$$1[xdata.core._METADATA_KEY]||null};xdata.core.InputEnv=function(){};xdata.core.InputEnv.prototype.isPresent=function(inputName$$1,acceptNull$$1){};xdata.core.InputEnv.prototype.getFieldName=function(inputName$$2,fieldName$$3){};xdata.TypeHandler=function(){};exportSymbol("xdata.TypeHandler",xdata.TypeHandler);xdata.TypeHandler.prototype.getMapping=function(){};exportProperty(xdata.TypeHandler.prototype,"getMapping",xdata.TypeHandler.prototype.getMapping);xdata.TypeHandler.prototype.getOperatorMapping=function(operator){};exportProperty(xdata.TypeHandler.prototype,"getOperatorMapping",xdata.TypeHandler.prototype.getOperatorMapping);xdata.TypeHandler.prototype.getOrderMapping=function(descending$$1){};
exportProperty(xdata.TypeHandler.prototype,"getOrderMapping",xdata.TypeHandler.prototype.getOrderMapping);xdata.TypeHandler.prototype.read=function(mappedValue){};exportProperty(xdata.TypeHandler.prototype,"read",xdata.TypeHandler.prototype.read);xdata.TypeHandler.prototype.write=function(mappedValue$$1,value$$63){};exportProperty(xdata.TypeHandler.prototype,"write",xdata.TypeHandler.prototype.write);xdata.TypeHandler.MappedValue=function(){};exportProperty(xdata.TypeHandler,"MappedValue",xdata.TypeHandler.MappedValue);
xdata.TypeHandler.MappedValue.prototype.setDefault=function(value$$64){};exportProperty(xdata.TypeHandler.MappedValue.prototype,"setDefault",xdata.TypeHandler.MappedValue.prototype.setDefault);xdata.TypeHandler.MappedValue.prototype.getDefault=function(){};exportProperty(xdata.TypeHandler.MappedValue.prototype,"getDefault",xdata.TypeHandler.MappedValue.prototype.getDefault);xdata.TypeHandler.MappedValue.prototype.set=function(fieldName$$4,fieldValue){};
exportProperty(xdata.TypeHandler.MappedValue.prototype,"set",xdata.TypeHandler.MappedValue.prototype.set);xdata.TypeHandler.MappedValue.prototype.get=function(fieldName$$5){};exportProperty(xdata.TypeHandler.MappedValue.prototype,"get",xdata.TypeHandler.MappedValue.prototype.get);xdata.core.ValueMapper=function(object$$7){this._object=object$$7;this._baseName=null;this._baseIndex=null};xdata.core.ValueMapper.prototype.createCopy=function(){var copy=new xdata.core.ValueMapper(this._object);copy._baseName=this._baseName;copy._baseIndex=this._baseIndex;return copy};xdata.core.ValueMapper.prototype.setBaseName=function(baseName){this._baseName=baseName};xdata.core.ValueMapper.prototype.setBaseIndex=function(baseIndex){this._baseIndex=baseIndex};
xdata.core.ValueMapper.prototype.clearBaseIndex=function(){this._baseIndex=null};xdata.core.ValueMapper.prototype.clearBaseName=function(){this.clearBaseIndex();this._baseName=null};xdata.core.ValueMapper.prototype.setDefault=function(value$$65){this.set("",value$$65)};xdata.core.ValueMapper.prototype.getDefault=function(){return this.get("")};
xdata.core.ValueMapper.prototype.set=function(fieldName$$6,fieldValue$$1){var key$$10=this._getFieldName(fieldName$$6);if(this._baseIndex!==null){var array$$11=this._object[key$$10];if(!array$$11)this._object[key$$10]=array$$11=[];array$$11[this._baseIndex]=fieldValue$$1}else this._object[key$$10]=fieldValue$$1};xdata.core.ValueMapper.prototype.get=function(fieldName$$7){var key$$11=this._getFieldName(fieldName$$7);if(this._baseIndex!==null){var array$$12=this._object[key$$11];return array$$12&&array$$12[this._baseIndex]}else return this._object[key$$11]};
xdata.core.ValueMapper.prototype._getFieldName=function(fieldName$$8){if(!this._baseName)throw new Error("Mapped value is no longer usable");return xdata.core.ValueMapper.getFieldName(this._baseName,fieldName$$8)};xdata.core.ValueMapper.getFieldName=function(baseName$$1,fieldName$$9){return fieldName$$9?baseName$$1+"_"+fieldName$$9:baseName$$1};xdata.core.CompileInputEnv=function(parameters,inputValues){this._parameters=parameters;this._inputValues=inputValues};xdata.core.CompileInputEnv.prototype.isPresent=function(inputName$$3,acceptNull$$2){var accessor=this._inputValues.getRegisteredAccessor(inputName$$3);if(!accessor)return false;var mappedValue$$2=new xdata.core.ValueMapper(this._parameters);mappedValue$$2.setBaseName(inputName$$3);return accessor.isPresent(mappedValue$$2,acceptNull$$2)};
xdata.core.CompileInputEnv.prototype.getFieldName=function(inputName$$4,fieldName$$10){return xdata.core.ValueMapper.getFieldName(inputName$$4,fieldName$$10)};xdata.core.CompileInputEnv.prototype.computeInputFingerprint=function(inputNames,acceptNulls){var result$$5="";var i$$9=0;for(;i$$9<inputNames.length;i$$9++)result$$5=result$$5+(this.isPresent(inputNames[i$$9],acceptNulls)?"P":".");return result$$5};xdata.core.CompiledEntityInputs=function(normalizedEntityInputs,inputEnv){this._db=normalizedEntityInputs.getDatabase();this._baseEntity=normalizedEntityInputs.getBaseEntity();this._inputEnv=inputEnv;var providerStoreInputs=this._compileStoreInputs(normalizedEntityInputs.getNormalizedEntityInputs());this._providerStoreInputs=providerStoreInputs};
xdata.core.CompiledEntityInputs.prototype._compileStoreInputs=function(entityInputs){var providerStoreInputs$$1=[];var i$$10=0;for(;i$$10<entityInputs.length;i$$10++){var storeInputResult=this._compileTerm(entityInputs[i$$10]);Array.prototype.push.apply(providerStoreInputs$$1,storeInputResult)}return providerStoreInputs$$1};
xdata.core.CompiledEntityInputs.prototype._compileTerm=function(term$$2){var $jscomp$this$$1=this;if(!this._inputEnv.isPresent(term$$2.valueInput,true))return[];var input$$1=this._baseEntity.getInput(term$$2.input);var valueAccessor$$1=xdata.core.getValueAccessor(this._db,input$$1);var mapping=valueAccessor$$1.getMapping();return mapping.map(function(entry$$1){return{inputName:xdata.core.SchemaMapper.getInputFieldName(input$$1.getField(entry$$1.field)),valueParameter:$jscomp$this$$1._inputEnv.getFieldName(term$$2.valueInput,
entry$$1.field)}})};xdata.core.CompiledEntityInputs.prototype.getProviderStoreInputs=function(){return this._providerStoreInputs};xdata.core.InputValues=function(){this._defaults={};this._pending={};this._pendingPromises=[];this._mappedValue=new xdata.core.ValueMapper(this._defaults);this._constantCount=0;this._anonymousCount=0;this._expectedInputs=[];this._accessors={}};xdata.core.InputValues.prototype.registerConstant=function(accessor$$1,value$$66){return this._doRegisterConstant(false,accessor$$1,value$$66)};
xdata.core.InputValues.prototype.registerMultipleConstant=function(accessor$$2,value$$67){return this._doRegisterConstant(true,accessor$$2,value$$67)};xdata.core.InputValues.prototype._doRegisterConstant=function(multiple,accessor$$3,value$$68){var inputName$$5="_k"+this._constantCount++;this._setDefault(accessor$$3,inputName$$5,multiple,value$$68);this._accessors[inputName$$5]=accessor$$3;return inputName$$5};
xdata.core.InputValues.prototype.registerExpected=function(accessor$$4,inputName$$6,defaultValue){var actualInputName=this._doRegisterExpected(false,accessor$$4,inputName$$6,defaultValue);this._accessors[actualInputName]=accessor$$4;return actualInputName};
xdata.core.InputValues.prototype.registerMultipleExpected=function(accessor$$5,inputName$$7,defaultValue$$1){var actualInputName$$1=this._doRegisterExpected(true,accessor$$5,inputName$$7,defaultValue$$1);this._accessors[actualInputName$$1]=accessor$$5;return actualInputName$$1};xdata.core.InputValues.prototype.getRegisteredAccessor=function(inputName$$8){return this._accessors[inputName$$8]};
xdata.core.InputValues.prototype._doRegisterExpected=function(multiple$$1,accessor$$6,inputName$$9,defaultValue$$2){inputName$$9=inputName$$9||String(this._anonymousCount++);if(defaultValue$$2!==undefined)this._setDefault(accessor$$6,inputName$$9,multiple$$1,defaultValue$$2);this._expectedInputs.push({inputName:inputName$$9,multiple:multiple$$1});return inputName$$9};
xdata.core.InputValues.prototype._setDefault=function(accessor$$7,inputName$$10,multiple$$2,value$$69){var $jscomp$this$$2=this;this._mappedValue.setBaseName(inputName$$10);var writeResult;if(multiple$$2)writeResult=accessor$$7.writeMultiple(this._mappedValue,value$$69);else writeResult=accessor$$7.write(this._mappedValue,value$$69);if(xdata.util.isPromise(writeResult)){this._pending[inputName$$10]=true;this._pendingPromises.push(Promise.resolve(writeResult).then(function(){$jscomp$this$$2._pending[inputName$$10]=
false}));this._mappedValue=this._mappedValue.createCopy()}this._mappedValue.clearBaseName()};xdata.core.InputValues.prototype.isPresent=function(inputName$$11,acceptNull$$3){if(this._pending[inputName$$11])return true;var accessor$$8=this._accessors[inputName$$11];if(!accessor$$8)return false;var mappedValue$$3=new xdata.core.ValueMapper(this._defaults);mappedValue$$3.setBaseName(inputName$$11);return accessor$$8.isPresent(mappedValue$$3,acceptNull$$3)};
xdata.core.InputValues.prototype.getFieldName=function(inputName$$12,fieldName$$11){return xdata.core.ValueMapper.getFieldName(inputName$$12,fieldName$$11)};
xdata.core.InputValues.prototype.prepareObject=function(parameters$$1){var $jscomp$this$$3=this;var defaults=this._defaults;var actuals=Object.create(defaults);return Promise.all(this._pendingPromises).then(function(){if($jscomp$this$$3._expectedInputs.length<=0||!parameters$$1)return;var mappedValue$$4=new xdata.core.ValueMapper(actuals);return Promise.all($jscomp$this$$3._expectedInputs.map(function(expected){var value$$70=parameters$$1[expected.inputName];if(value$$70===undefined)return;mappedValue$$4.setBaseName(expected.inputName);
var writeResult$$1;var accessor$$9=$jscomp$this$$3._accessors[expected.inputName];if(expected.multiple)writeResult$$1=accessor$$9.writeMultiple(mappedValue$$4,value$$70);else writeResult$$1=accessor$$9.write(mappedValue$$4,value$$70);if(xdata.util.isPromise(writeResult$$1))mappedValue$$4=mappedValue$$4.createCopy();mappedValue$$4.clearBaseName();return writeResult$$1}))}).then(function(){return actuals})};xdata.core.NormalizedEntityInputs=function(db$$3,baseEntity,inputs,inputValues$$1){this._db=db$$3;this._baseEntity=baseEntity;this._inputNames=[];this._normalizedInputs=this._normalizeInputs(inputs,inputValues$$1)};xdata.core.NormalizedEntityInputs.prototype.getDatabase=function(){return this._db};xdata.core.NormalizedEntityInputs.prototype.getBaseEntity=function(){return this._baseEntity};
xdata.core.NormalizedEntityInputs.prototype._normalizeInputs=function(inputs$$1,inputValues$$2){var $jscomp$this$$4=this;if(!Array.isArray(inputs$$1))return Object.keys(inputs$$1).map(function(key$$12){return $jscomp$this$$4._normalizeTerm({input:key$$12,value:inputs$$1[key$$12]},inputValues$$2)});return inputs$$1.map(function(term$$3){return $jscomp$this$$4._normalizeTerm(term$$3,inputValues$$2)})};
xdata.core.NormalizedEntityInputs.prototype._normalizeTerm=function(term$$4,inputValues$$3){var inputName$$13=this._externalizeInput(term$$4,inputValues$$3);if(!inputValues$$3.isPresent(inputName$$13,true))this._inputNames.push(inputName$$13);return{input:term$$4.input,valueInput:inputName$$13}};
xdata.core.NormalizedEntityInputs.prototype._externalizeInput=function(term$$5,inputValues$$4){var input$$2=this._baseEntity.getInput(term$$5.input);var valueAccessor$$2=xdata.core.getValueAccessor(this._db,input$$2);if(!xdata.core.isEmptyValue(term$$5.value,true))if(term$$5.valueInput)return inputValues$$4.registerExpected(valueAccessor$$2,term$$5.valueInput,term$$5.value);else return inputValues$$4.registerConstant(valueAccessor$$2,term$$5.value);return inputValues$$4.registerExpected(valueAccessor$$2,
term$$5.valueInput)};xdata.core.NormalizedEntityInputs.prototype.getInputNames=function(){return this._inputNames};xdata.core.NormalizedEntityInputs.prototype.getNormalizedEntityInputs=function(){return this._normalizedInputs};xdata.core.EntityInputsCompiler=function(db$$4,baseEntity$$1,inputs$$2,inputValues$$5){this._normalizedEntityInputs=new xdata.core.NormalizedEntityInputs(db$$4,baseEntity$$1,inputs$$2,inputValues$$5);this._inputValues=inputValues$$5;this._cache={}};
xdata.core.EntityInputsCompiler.prototype.compile=function(parameters$$2){var inputEnv$$1=new xdata.core.CompileInputEnv(parameters$$2,this._inputValues);var key$$13=inputEnv$$1.computeInputFingerprint(this._normalizedEntityInputs.getInputNames(),true);var compiledEntityInputs=this._cache[key$$13];if(!compiledEntityInputs){compiledEntityInputs=new xdata.core.CompiledEntityInputs(this._normalizedEntityInputs,inputEnv$$1);this._cache[key$$13]=compiledEntityInputs}return compiledEntityInputs};xdata.core.CompiledFilter=function(normalizedFilter,inputEnv$$2){this._db=normalizedFilter.getDatabase();this._baseElement=normalizedFilter.getBaseElement();this._inputEnv=inputEnv$$2;this._requiredInputs={expected:0,found:0};this._impliedInputs={expected:0,found:0};var compileResult=this._compileExpression(normalizedFilter.getNormalizedExpression());var applicableFixedResult=this._computeApplicableFixedResult(normalizedFilter.isOneImpliedInputRequired());this._providerExpr=compileResult.providerExpr;
this._fixedResult=applicableFixedResult!==undefined?applicableFixedResult:compileResult.fixedResult};xdata.core.CompiledFilter._Result;
xdata.core.CompiledFilter.prototype._compileExpression=function(expression$$3){if(Array.isArray(expression$$3))if(expression$$3.length>1)return this._compileLogicAndExpression(expression$$3);else if(expression$$3.length===1)return this._compileTerm(expression$$3[0]);else throw new Error("Invalid 0-length array in expression");if(expression$$3[xdata.LogicOperator.AND])return this._compileLogicAndExpression(expression$$3[xdata.LogicOperator.AND]);else if(expression$$3[xdata.LogicOperator.OR])return this._compileLogicOrExpression(expression$$3[xdata.LogicOperator.OR]);
else if(expression$$3[xdata.LogicOperator.NOT])return this._compileLogicNotExpression(expression$$3[xdata.LogicOperator.NOT]);return this._compileTerm(expression$$3)};xdata.core.CompiledFilter.prototype._compileLogicAndExpression=function(operands){return this._compileLogicBinaryExpression(operands,false,true,xdata.LogicOperator.AND)};xdata.core.CompiledFilter.prototype._compileLogicOrExpression=function(operands$$1){return this._compileLogicBinaryExpression(operands$$1,true,false,xdata.LogicOperator.OR)};
xdata.core.CompiledFilter.prototype._compileLogicBinaryExpression=function(operands$$2,absorbingValue,identityValue,providerOperator){var providerOperands=[];var i$$11=0;for(;i$$11<operands$$2.length;i$$11++){var operandResult=this._compileExpression(operands$$2[i$$11]);if(!operandResult.providerExpr){if(operandResult.fixedResult===absorbingValue)return{fixedResult:absorbingValue};else if(operandResult.fixedResult===identityValue)continue;return{fixedResult:null}}providerOperands.push(operandResult.providerExpr)}var providerExpr;
if(providerOperands.length>1)providerExpr={operator:providerOperator,operands:providerOperands};else providerExpr=providerOperands[0];return{providerExpr:providerExpr}};
xdata.core.CompiledFilter.prototype._compileLogicNotExpression=function(operand){var operandResult$$1=this._compileExpression(operand);if(!operandResult$$1.providerExpr){if(typeof operandResult$$1.fixedResult==="boolean")return{fixedResult:!operandResult$$1.fixedResult};return{fixedResult:null}}var providerExpr$$1={operator:xdata.LogicOperator.NOT,operands:[operandResult$$1.providerExpr]};return{providerExpr:providerExpr$$1}};
xdata.core.CompiledFilter.prototype._compileTerm=function(term$$6){var operator$$1=term$$6.operator;var valueOperator=term$$6.valueOperator;var valueInput=term$$6.valueInput;var impliedResult=term$$6.implied!==undefined?!!term$$6.implied:null;var inputCounters=impliedResult===null?this._requiredInputs:this._impliedInputs;inputCounters.expected++;var binary=xdata.ValueOperator.isBinary(operator$$1);if(binary)if(!this._inputEnv.isPresent(valueInput))if(impliedResult===null)return{fixedResult:null};
else return{fixedResult:impliedResult};inputCounters.found++;var propertyRef$$1=xdata.core.ElementRef.of(this._baseElement,term$$6.property);var valueAccessor$$3=xdata.core.getValueAccessor(this._db,propertyRef$$1);var operatorMapping=valueAccessor$$3.getOperatorMapping(term$$6.operator||xdata.ValueOperator.EQUAL);var providerTerms$$2=operatorMapping.map(function(entry$$2){return{fieldPath:propertyRef$$1.computeMappedAttributeFieldPath(entry$$2.field),operator:entry$$2.operator,valueParameter:binary?
this._inputEnv.getFieldName(valueInput,entry$$2.field):undefined,internalOperator:binary?valueOperator:undefined}},this);var providerExpr$$2;if(providerTerms$$2.length>1)providerExpr$$2={operator:xdata.LogicOperator.AND,operands:providerTerms$$2};else providerExpr$$2=providerTerms$$2[0];return{providerExpr:providerExpr$$2}};
xdata.core.CompiledFilter.prototype._computeApplicableFixedResult=function(oneImpliedInputRequired){var requiredInputs=this._requiredInputs;var impliedInputs=this._impliedInputs;if(requiredInputs.expected>0&&requiredInputs.found<requiredInputs.expected||oneImpliedInputRequired&&(impliedInputs.expected>0&&impliedInputs.found===0))return null;if(requiredInputs.expected===0&&!oneImpliedInputRequired&&impliedInputs.found===0)return true;return undefined};
xdata.core.CompiledFilter.prototype.isApplicable=function(){return this._fixedResult!==null};xdata.core.CompiledFilter.prototype._checkApplicable=function(){if(this._fixedResult===null)throw new Error("Not applicable");return this._fixedResult};xdata.core.CompiledFilter.prototype.isFixed=function(){var applicableFixedResult$$1=this._checkApplicable();return applicableFixedResult$$1!==undefined};
xdata.core.CompiledFilter.prototype.getFixedResult=function(){var applicableFixedResult$$2=this._checkApplicable();if(applicableFixedResult$$2===undefined)throw new Error("Result is not fixed");return applicableFixedResult$$2};xdata.core.CompiledFilter.prototype.getProviderExpression=function(){this._checkApplicable();if(this._providerExpr===undefined)throw new Error("Result is fixed");return this._providerExpr};xdata.Filter=function(){};exportSymbol("xdata.Filter",xdata.Filter);xdata.Filter.Config=function(){};exportProperty(xdata.Filter,"Config",xdata.Filter.Config);xdata.Filter.Config.prototype.oneImpliedInputRequired;exportProperty(xdata.Filter.Config.prototype,"oneImpliedInputRequired",xdata.Filter.Config.prototype.oneImpliedInputRequired);xdata.Filter.GenericTerm=function(){};exportProperty(xdata.Filter,"GenericTerm",xdata.Filter.GenericTerm);xdata.Filter.GenericTerm.prototype.property;
exportProperty(xdata.Filter.GenericTerm.prototype,"property",xdata.Filter.GenericTerm.prototype.property);xdata.Filter.GenericTerm.prototype.operator;exportProperty(xdata.Filter.GenericTerm.prototype,"operator",xdata.Filter.GenericTerm.prototype.operator);xdata.Filter.GenericTerm.prototype.value;exportProperty(xdata.Filter.GenericTerm.prototype,"value",xdata.Filter.GenericTerm.prototype.value);xdata.Filter.GenericTerm.prototype.valueInput;
exportProperty(xdata.Filter.GenericTerm.prototype,"valueInput",xdata.Filter.GenericTerm.prototype.valueInput);xdata.Filter.GenericTerm.prototype.valueOperator;exportProperty(xdata.Filter.GenericTerm.prototype,"valueOperator",xdata.Filter.GenericTerm.prototype.valueOperator);xdata.Filter.GenericTerm.prototype.implied;exportProperty(xdata.Filter.GenericTerm.prototype,"implied",xdata.Filter.GenericTerm.prototype.implied);xdata.Filter.GenericTerm.prototype.config;
exportProperty(xdata.Filter.GenericTerm.prototype,"config",xdata.Filter.GenericTerm.prototype.config);xdata.Filter.SingleEqualTerm;exportProperty(xdata.Filter,"SingleEqualTerm",xdata.Filter.SingleEqualTerm);xdata.Filter.Term;exportProperty(xdata.Filter,"Term",xdata.Filter.Term);xdata.Filter.LogicExpression=function(){};exportProperty(xdata.Filter,"LogicExpression",xdata.Filter.LogicExpression);xdata.Filter.AndLogicExpression=function(){};exportProperty(xdata.Filter,"AndLogicExpression",xdata.Filter.AndLogicExpression);
xdata.Filter.FullAndLogicExpression=function(){};exportProperty(xdata.Filter,"FullAndLogicExpression",xdata.Filter.FullAndLogicExpression);xdata.Filter.FullAndLogicExpression.and;exportProperty(xdata.Filter.FullAndLogicExpression,"and",xdata.Filter.FullAndLogicExpression.and);xdata.Filter.FullAndLogicExpression.config;exportProperty(xdata.Filter.FullAndLogicExpression,"config",xdata.Filter.FullAndLogicExpression.config);xdata.Filter.CompactAndLogicExpression=function(){};
exportProperty(xdata.Filter,"CompactAndLogicExpression",xdata.Filter.CompactAndLogicExpression);xdata.Filter.OrLogicExpression=function(){};exportProperty(xdata.Filter,"OrLogicExpression",xdata.Filter.OrLogicExpression);xdata.Filter.OrLogicExpression.or;exportProperty(xdata.Filter.OrLogicExpression,"or",xdata.Filter.OrLogicExpression.or);xdata.Filter.OrLogicExpression.config;exportProperty(xdata.Filter.OrLogicExpression,"config",xdata.Filter.OrLogicExpression.config);
xdata.Filter.NotLogicExpression=function(){};exportProperty(xdata.Filter,"NotLogicExpression",xdata.Filter.NotLogicExpression);xdata.Filter.NotLogicExpression.not;exportProperty(xdata.Filter.NotLogicExpression,"not",xdata.Filter.NotLogicExpression.not);xdata.Filter.NotLogicExpression.config;exportProperty(xdata.Filter.NotLogicExpression,"config",xdata.Filter.NotLogicExpression.config);xdata.Filter.Expression;exportProperty(xdata.Filter,"Expression",xdata.Filter.Expression);xdata.LogicOperator={NOT:"not",AND:"and",OR:"or"};exportSymbol("xdata.LogicOperator",xdata.LogicOperator);xdata.core.NormalizedFilter=function(db$$5,baseElement$$3,filterExpr,inputValues$$6){this._db=db$$5;this._baseElement=baseElement$$3;this._inputNames=[];this._normalizedExpr=this._normalizeExpression(filterExpr,inputValues$$6);this._oneImpliedInputRequired=!!(filterExpr.config&&filterExpr.config.oneImpliedInputRequired)};xdata.core.NormalizedFilter.prototype.getDatabase=function(){return this._db};xdata.core.NormalizedFilter.prototype.getBaseElement=function(){return this._baseElement};
xdata.core.NormalizedFilter.prototype._normalizeExpression=function(expression$$4,inputValues$$7){if(Array.isArray(expression$$4))if(expression$$4.length>1)return this._normalizeLogicExpression(xdata.LogicOperator.AND,expression$$4,inputValues$$7);else if(expression$$4.length===1)return this._normalizeTerm(expression$$4[0],inputValues$$7);else throw new Error("Invalid 0-length array in expression");var logicOperators=xdata.util.getEnumValues(xdata.LogicOperator);var i$$12=0;for(;i$$12<logicOperators.length;i$$12++)if(expression$$4[logicOperators[i$$12]])return this._normalizeLogicExpression(logicOperators[i$$12],
expression$$4[logicOperators[i$$12]],inputValues$$7);return this._normalizeTerm(expression$$4,inputValues$$7)};xdata.core.NormalizedFilter.prototype._normalizeLogicExpression=function(operator$$2,operands$$3,inputValues$$8){var logicExpr={};if(!Array.isArray(operands$$3))logicExpr[operator$$2]=this._normalizeExpression(operands$$3,inputValues$$8);else logicExpr[operator$$2]=operands$$3.map(function(operand$$1){return this._normalizeExpression(operand$$1,inputValues$$8)},this);return logicExpr};
xdata.core.NormalizedFilter.prototype._normalizeTerm=function(term$$7,inputValues$$9){if(typeof term$$7!=="object")term$$7={property:term$$7};var operator$$3=term$$7.operator||xdata.ValueOperator.EQUAL;var valueOperator$$1=term$$7.valueOperator||xdata.CollectionOperator.ANY;if(xdata.ValueOperator.isBinary(operator$$3)){var inputName$$14=this._externalizeInput(term$$7,inputValues$$9);if(!inputValues$$9.isPresent(inputName$$14))this._inputNames.push(inputName$$14);return{property:term$$7.property,operator:operator$$3,
value:undefined,valueInput:inputName$$14,valueOperator:valueOperator$$1,implied:term$$7.implied}}return{property:term$$7.property,operator:operator$$3}};
xdata.core.NormalizedFilter.prototype._externalizeInput=function(term$$8,inputValues$$10){var propertyRef$$2=xdata.core.ElementRef.of(this._baseElement,term$$8.property);var valueAccessor$$4=xdata.core.getValueAccessor(this._db,propertyRef$$2);if(!xdata.core.isEmptyValue(term$$8.value))if(term$$8.valueInput)return inputValues$$10.registerMultipleExpected(valueAccessor$$4,term$$8.valueInput,term$$8.value);else return inputValues$$10.registerMultipleConstant(valueAccessor$$4,term$$8.value);return inputValues$$10.registerMultipleExpected(valueAccessor$$4,
term$$8.valueInput)};xdata.core.NormalizedFilter.prototype.getInputNames=function(){return this._inputNames};xdata.core.NormalizedFilter.prototype.getNormalizedExpression=function(){return this._normalizedExpr};xdata.core.NormalizedFilter.prototype.isOneImpliedInputRequired=function(){return this._oneImpliedInputRequired};xdata.core.FilterCompiler=function(db$$6,baseElement$$4,filterExpr$$1,inputValues$$11){this._normalizedFilter=new xdata.core.NormalizedFilter(db$$6,baseElement$$4,filterExpr$$1,inputValues$$11);this._inputValues=inputValues$$11;this._cache={}};
xdata.core.FilterCompiler.prototype.compile=function(parameters$$3){var inputEnv$$3=new xdata.core.CompileInputEnv(parameters$$3,this._inputValues);var key$$14=inputEnv$$3.computeInputFingerprint(this._normalizedFilter.getInputNames());var compiledFilter=this._cache[key$$14];if(!compiledFilter){compiledFilter=new xdata.core.CompiledFilter(this._normalizedFilter,inputEnv$$3);this._cache[key$$14]=compiledFilter}return compiledFilter};xdata.core.CompiledInputs=function(normalizedInputs,inputEnv$$4){this._db=normalizedInputs.getDatabase();this._baseElement=normalizedInputs.getBaseElement();this._inputEnv=inputEnv$$4;var providerInputs=this._compileInputs(normalizedInputs.getNormalizedInputs());this._providerInputs=providerInputs};
xdata.core.CompiledInputs.prototype._compileInputs=function(inputs$$3){var providerInputs$$1=[];var i$$13=0;for(;i$$13<inputs$$3.length;i$$13++){var inputResult=this._compileTerm(inputs$$3[i$$13]);Array.prototype.push.apply(providerInputs$$1,inputResult)}return providerInputs$$1};
xdata.core.CompiledInputs.prototype._compileTerm=function(term$$9){if(!this._inputEnv.isPresent(term$$9.valueInput,true))return[];var propertyRef$$3=xdata.core.ElementRef.of(this._baseElement,term$$9.property);var valueAccessor$$5=xdata.core.getValueAccessor(this._db,propertyRef$$3);var mapping$$1=valueAccessor$$5.getMapping();return mapping$$1.map(function(entry$$3){return{fieldPath:propertyRef$$3.computeMappedAttributeFieldPath(entry$$3.field),valueParameter:this._inputEnv.getFieldName(term$$9.valueInput,
entry$$3.field)}},this)};xdata.core.CompiledInputs.prototype.isEmpty=function(){return this._providerInputs.length<=0};xdata.core.CompiledInputs.prototype.getProviderInputs=function(){if(this.isEmpty())throw new Error("Empty");return this._providerInputs};xdata.core.NormalizedInputs=function(db$$7,baseElement$$5,inputs$$4,inputValues$$12){this._db=db$$7;this._baseElement=baseElement$$5;this._inputNames=[];this._normalizedInputs=this._normalizeInputs(inputs$$4,inputValues$$12)};xdata.core.NormalizedInputs.prototype.getDatabase=function(){return this._db};xdata.core.NormalizedInputs.prototype.getBaseElement=function(){return this._baseElement};
xdata.core.NormalizedInputs.prototype._normalizeInputs=function(inputs$$5,inputValues$$13){var $jscomp$this$$5=this;if(!Array.isArray(inputs$$5))return Object.keys(inputs$$5).map(function(key$$15){return $jscomp$this$$5._normalizeTerm({property:key$$15,value:inputs$$5[key$$15]},inputValues$$13)});return inputs$$5.map(function(term$$10){return $jscomp$this$$5._normalizeTerm(term$$10,inputValues$$13)})};
xdata.core.NormalizedInputs.prototype._normalizeTerm=function(term$$11,inputValues$$14){var inputName$$15=this._externalizeInput(term$$11,inputValues$$14);if(!inputValues$$14.isPresent(inputName$$15,true))this._inputNames.push(inputName$$15);return{property:term$$11.property,valueInput:inputName$$15}};
xdata.core.NormalizedInputs.prototype._externalizeInput=function(term$$12,inputValues$$15){var propertyRef$$4=xdata.core.ElementRef.of(this._baseElement,term$$12.property);var valueAccessor$$6=xdata.core.getValueAccessor(this._db,propertyRef$$4);if(!xdata.core.isEmptyValue(term$$12.value,true))if(term$$12.valueInput)return inputValues$$15.registerExpected(valueAccessor$$6,term$$12.valueInput,term$$12.value);else return inputValues$$15.registerConstant(valueAccessor$$6,term$$12.value);return inputValues$$15.registerExpected(valueAccessor$$6,
term$$12.valueInput)};xdata.core.NormalizedInputs.prototype.getInputNames=function(){return this._inputNames};xdata.core.NormalizedInputs.prototype.getNormalizedInputs=function(){return this._normalizedInputs};xdata.core.InputsCompiler=function(db$$8,baseElement$$6,inputs$$6,inputValues$$16){this._normalizedInputs=new xdata.core.NormalizedInputs(db$$8,baseElement$$6,inputs$$6,inputValues$$16);this._inputValues=inputValues$$16;this._cache={}};
xdata.core.InputsCompiler.prototype.compile=function(parameters$$4){var inputEnv$$5=new xdata.core.CompileInputEnv(parameters$$4,this._inputValues);var key$$16=inputEnv$$5.computeInputFingerprint(this._normalizedInputs.getInputNames(),true);var compiledInputs=this._cache[key$$16];if(!compiledInputs){compiledInputs=new xdata.core.CompiledInputs(this._normalizedInputs,inputEnv$$5);this._cache[key$$16]=compiledInputs}return compiledInputs};xdata.core.ChangeTrackerDispatcher=function(notifiedMethodName){this._notifiedMethodName=notifiedMethodName;this._changeTrackers=[]};xdata.core.ChangeTrackerDispatcher.prototype.isEmpty=function(){return this._changeTrackers.length<=0};xdata.core.ChangeTrackerDispatcher.prototype.clear=function(){if(this._changeTrackers.length>0){this._changeTrackers.length=0;return true}return false};
xdata.core.ChangeTrackerDispatcher.prototype.add=function(changeTracker$$2){var i$$14=0;for(;i$$14<this._changeTrackers.length;i$$14++)if(this._changeTrackers[i$$14]===changeTracker$$2)return false;this._changeTrackers.push(changeTracker$$2);return true};xdata.core.ChangeTrackerDispatcher.prototype.remove=function(changeTracker$$3){var i$$15=0;for(;i$$15<this._changeTrackers.length;i$$15++)if(this._changeTrackers[i$$15]===changeTracker$$3){this._changeTrackers.splice(i$$15,1);return true}return false};
xdata.core.ChangeTrackerDispatcher.prototype.getOutputsByTargetName=function(){var result$$6={};this._changeTrackers.forEach(function(changeTracker$$4,i$$16){result$$6["tracker:"+i$$16]=changeTracker$$4.tracked;if(changeTracker$$4.trackedOld)result$$6["tracker-old:"+i$$16]=changeTracker$$4.trackedOld});return result$$6};
xdata.core.ChangeTrackerDispatcher.prototype.notify=function(targets){var notifiedMethodName$$1=this._notifiedMethodName;this._changeTrackers.forEach(function(changeTracker$$5,i$$17){var values$$3=targets["tracker:"+i$$17];var oldValues=undefined;if(changeTracker$$5.trackedOld)oldValues=targets["tracker-old:"+i$$17];var method$$1=changeTracker$$5[notifiedMethodName$$1];method$$1&&method$$1.call(changeTracker$$5,values$$3,oldValues)})};xdata.core.CompiledOutputs=function(db$$9,baseElement$$7,outputsByTargetName,outputValues){var $jscomp$this$$6=this;this._db=db$$9;this._baseElement=baseElement$$7;this._outputValues=outputValues;this._outputNamesCache={};this._outputNamesCount=0;this._providerOutputs=[];Object.keys(outputsByTargetName).forEach(function(targetName){$jscomp$this$$6._outputValues.defineTarget(targetName);$jscomp$this$$6._compileOutputs(outputsByTargetName[targetName],targetName,$jscomp$this$$6._providerOutputs)})};
xdata.core.CompiledOutputs.prototype._compileOutputs=function(outputs,targetName$$1,providerTerms$$3){if(typeof outputs==="string")this._compileOutputTerm(outputs,targetName$$1,null,providerTerms$$3);else if(Array.isArray(outputs))outputs.forEach(function(property$$2){this._compileOutputTerm(property$$2,targetName$$1,property$$2,providerTerms$$3)},this);else Object.keys(outputs).forEach(function(key$$17){this._compileOutputTerm(outputs[key$$17],targetName$$1,key$$17,providerTerms$$3)},this)};
xdata.core.CompiledOutputs.prototype._compileOutputTerm=function(property$$3,targetName$$2,outputPropertyName,providerTerms$$4){var propertyRef$$5=xdata.core.ElementRef.of(this._baseElement,property$$3);var valueAccessor$$7=xdata.core.getValueAccessor(this._db,propertyRef$$5);var propertyRefKey=propertyRef$$5.toUniqueKey();var outputName=this._outputNamesCache[propertyRefKey];var firstRequest=!outputName;if(!outputName)this._outputNamesCache[propertyRefKey]=outputName="o"+this._outputNamesCount++;
if(outputPropertyName===null)this._outputValues.registerLoneValue(valueAccessor$$7,outputName,targetName$$2);else this._outputValues.registerObjectProperty(valueAccessor$$7,outputName,targetName$$2,outputPropertyName);if(firstRequest){var mapping$$2=valueAccessor$$7.getMapping();mapping$$2.forEach(function(entry$$4){providerTerms$$4.push({fieldPath:propertyRef$$5.computeMappedAttributeFieldPath(entry$$4.field),propertyName:this._outputValues.getFieldName(outputName,entry$$4.field)})},this)}};
xdata.core.CompiledOutputs.prototype.getProviderOutputs=function(){return this._providerOutputs};xdata.core.OutputValues=function(){this._extractions=[];this._extractionsByOutputName={};this._targetNames=[];this._targetTypes={}};xdata.core.OutputValues._Extraction;xdata.core.OutputValues.prototype.defineTarget=function(targetName$$3){if(this._targetTypes.hasOwnProperty(targetName$$3))throw new Error("Target "+targetName$$3+" already defined");this._targetTypes[targetName$$3]=undefined;this._targetNames.push(targetName$$3)};
xdata.core.OutputValues.prototype.registerObjectProperty=function(accessor$$10,outputName$$1,targetName$$4,propertyName$$8){if(!this._targetTypes.hasOwnProperty(targetName$$4))throw new Error("Target "+targetName$$4+" not defined");var targetType=this._targetTypes[targetName$$4];if(targetType===undefined)this._targetTypes[targetName$$4]=false;else if(targetType===true)throw new Error("Target "+targetName$$4+" constructed object conflicts with lone value");this._addExtractedOutput(accessor$$10,outputName$$1,
targetName$$4,propertyName$$8)};
xdata.core.OutputValues.prototype.registerLoneValue=function(accessor$$11,outputName$$2,targetName$$5){if(!this._targetTypes.hasOwnProperty(targetName$$5))throw new Error("Target "+targetName$$5+" not defined");var targetType$$1=this._targetTypes[targetName$$5];if(targetType$$1===undefined)this._targetTypes[targetName$$5]=true;else if(targetType$$1===false)throw new Error("Target "+targetName$$5+" lone value conflicts with constructed object");this._addExtractedOutput(accessor$$11,outputName$$2,targetName$$5,
null)};
xdata.core.OutputValues.prototype._addExtractedOutput=function(accessor$$12,outputName$$3,targetName$$6,targetProperty){var extraction=this._extractionsByOutputName[outputName$$3];if(!extraction){extraction={accessor:accessor$$12,outputName:outputName$$3,targetProperties:Object.create(null)};this._extractionsByOutputName[outputName$$3]=extraction;this._extractions.push(extraction)}var targetProperties=extraction.targetProperties;var targetPropertyNames=targetProperties[targetName$$6];if(targetProperty===null){if(DEBUG&&
targetPropertyNames!==undefined)throw new Error("Lone value addition is always the first and only");targetProperties[targetName$$6]=null}else{if(targetPropertyNames===undefined)targetProperties[targetName$$6]=targetPropertyNames=[];targetPropertyNames.push(targetProperty)}};xdata.core.OutputValues.prototype.getFieldName=function(outputName$$4,fieldName$$12){return xdata.core.ValueMapper.getFieldName(outputName$$4,fieldName$$12)};
xdata.core.OutputValues.prototype.prepareTargets=function(result$$7){var outputTargets={};var asyncValuesPromises=[];this._doPrepareTargets(outputTargets,result$$7,this._targetNames,asyncValuesPromises);return Promise.all(asyncValuesPromises).then(function(){return outputTargets})};
xdata.core.OutputValues.prototype.prepareTarget=function(result$$8,targetName$$7){if(!this._targetTypes.hasOwnProperty(targetName$$7))throw new Error("Target "+targetName$$7+" not defined");var outputTargets$$1={};var asyncValuesPromises$$1=[];this._doPrepareTargets(outputTargets$$1,result$$8,[targetName$$7],asyncValuesPromises$$1);return Promise.all(asyncValuesPromises$$1).then(function(){return outputTargets$$1[targetName$$7]})};
xdata.core.OutputValues.prototype._doPrepareTargets=function(processedResults,result$$9,targetNames,asyncValuesPromises$$2){var mappedValue$$5=new xdata.core.ValueMapper(result$$9);var $jscomp$loop$7={};var i$$18=0;for(;i$$18<this._extractions.length;$jscomp$loop$7={extraction:$jscomp$loop$7.extraction},i$$18++){$jscomp$loop$7.extraction=this._extractions[i$$18];mappedValue$$5.setBaseName($jscomp$loop$7.extraction.outputName);var readResult=$jscomp$loop$7.extraction.accessor.read(mappedValue$$5);
var j=0;for(;j<targetNames.length;j++){var targetName$$8=targetNames[j];var targetPropertyNames$$1=$jscomp$loop$7.extraction.targetProperties[targetName$$8];if(targetPropertyNames$$1===undefined)continue;if(readResult!==undefined)if(targetPropertyNames$$1!==null){var processed=processedResults[targetName$$8]||(processedResults[targetName$$8]={});var k=0;for(;k<targetPropertyNames$$1.length;k++)processed[targetPropertyNames$$1[k]]=readResult}else processedResults[targetName$$8]=readResult}var readIsAsync=
xdata.util.isPromise(readResult);if(readIsAsync)mappedValue$$5=mappedValue$$5.createCopy();mappedValue$$5.clearBaseName();if(readIsAsync)asyncValuesPromises$$2.push(readResult.then(function($jscomp$loop$7$$1){return function(value$$71){var j$0=0;for(;j$0<targetNames.length;j$0++){var targetName$1=targetNames[j$0];var targetPropertyNames$2=$jscomp$loop$7$$1.extraction.targetProperties[targetName$1];if(targetPropertyNames$2!==null){var processed$3=processedResults[targetName$1];var k$4=0;for(;k$4<targetPropertyNames$2.length;k$4++)if(value$$71!==
undefined)processed$3[targetPropertyNames$2[k$4]]=value$$71;else delete processed$3[targetPropertyNames$2[k$4]]}else processedResults[targetName$1]=value$$71}}}($jscomp$loop$7)))}var i$5=0;for(;i$5<targetNames.length;i$5++){var targetName$6=targetNames[i$5];if(!processedResults.hasOwnProperty(targetName$6))processedResults[targetName$6]={}}};xdata.Metadata=function(){};exportSymbol("xdata.Metadata",xdata.Metadata);xdata.Metadata.prototype.totalCount;exportProperty(xdata.Metadata.prototype,"totalCount",xdata.Metadata.prototype.totalCount);xdata.Cursor=function(){};exportSymbol("xdata.Cursor",xdata.Cursor);xdata.Cursor.prototype.next=function(){};exportProperty(xdata.Cursor.prototype,"next",xdata.Cursor.prototype.next);xdata.Cursor.prototype.getMetadata=function(){};exportProperty(xdata.Cursor.prototype,"getMetadata",xdata.Cursor.prototype.getMetadata);xdata.core.MetadataImpl=function(providerMetadata$$2){this.totalCount=providerMetadata$$2?providerMetadata$$2.totalCount:undefined};xdata.core.ResultCursor=function(providerResultPromise,elementConverter,elementConverterContext){this._adapter=providerResultPromise.then(function(providerResult$$2){if(typeof providerResult$$2!=="object")throw new Error("Provider result not processable as cursor");var providerElements;if(Array.isArray(providerResult$$2)||"next"in providerResult$$2)providerElements=providerResult$$2;else providerElements=[providerResult$$2];return new xdata.core.ResultCursor.Adapter(providerElements,elementConverter,
elementConverterContext)})};exportSymbol("xdata.core.ResultCursor",xdata.core.ResultCursor);xdata.core.ResultCursor.prototype.next=function(){return this._adapter.then(function(adapter){return adapter.next()})};exportProperty(xdata.core.ResultCursor.prototype,"next",xdata.core.ResultCursor.prototype.next);xdata.core.ResultCursor.prototype.getMetadata=function(){return this._adapter.then(function(adapter$$1){return adapter$$1.getMetadata()})};
exportProperty(xdata.core.ResultCursor.prototype,"getMetadata",xdata.core.ResultCursor.prototype.getMetadata);xdata.core.ResultCursor._ProviderElementsResult;
xdata.core.ResultCursor.Adapter=function(providerElements$$1,elementConverter$$1,elementConverterContext$$1){this._providerElements=providerElements$$1;this._nextIndex=Array.isArray(providerElements$$1)?0:-1;this._iterElementFactory=function(done,adapteeValue){if(adapteeValue===undefined)return Promise.resolve({done:done,value:undefined});return elementConverter$$1.call(elementConverterContext$$1,adapteeValue).then(function(value$$72){return{done:done,value:value$$72}})}};
xdata.core.ResultCursor.Adapter.prototype.next=function(){var iterElementFactory=this._iterElementFactory;if(this._nextIndex>=0)if(this._nextIndex>=this._providerElements.length)return iterElementFactory(true);else{var index$$36=this._nextIndex++;return iterElementFactory(false,this._providerElements[index$$36])}return Promise.resolve(this._providerElements.next()).then(function(iterElement){return iterElementFactory(iterElement.done,iterElement.value)})};
xdata.core.ResultCursor.Adapter.prototype.getMetadata=function(){var providerMetadata$$3=this._providerElements?xdata.core.extractProviderMetadata(this._providerElements):null;var metadata$$1=new xdata.core.MetadataImpl(providerMetadata$$3);return Promise.resolve(metadata$$1)};xdata.core.ResultExtractor=function(){};xdata.core.ResultExtractor.prototype.getProviderOutputs=function(){};xdata.core.ResultExtractor.prototype.extract=function(providerResultPromise$$1){};xdata.util.ObjectMap=function(){this._buckets={}};exportSymbol("xdata.util.ObjectMap",xdata.util.ObjectMap);xdata.util.ObjectMap.prototype.clear=function(){this._buckets={}};exportProperty(xdata.util.ObjectMap.prototype,"clear",xdata.util.ObjectMap.prototype.clear);
xdata.util.ObjectMap.prototype.get=function(key$$18){var bucket=this._buckets[xdata.util.computeHashCode(key$$18)];if(!bucket)return undefined;var i$$19=0;for(;i$$19<bucket.length;i$$19++){var entry$$5=bucket[i$$19];if(xdata.util.equal(key$$18,entry$$5.key))return entry$$5.value}};exportProperty(xdata.util.ObjectMap.prototype,"get",xdata.util.ObjectMap.prototype.get);
xdata.util.ObjectMap.prototype.put=function(key$$19,value$$73){var keyHash=xdata.util.computeHashCode(key$$19);var bucket$$1=this._buckets[keyHash];if(!bucket$$1)this._buckets[keyHash]=bucket$$1=[];var i$$20=0;for(;i$$20<bucket$$1.length;i$$20++){var entry$$6=bucket$$1[i$$20];if(xdata.util.equal(key$$19,entry$$6.key)){var oldValue=entry$$6.value;entry$$6.value=value$$73;return oldValue}}bucket$$1.push({key:key$$19,value:value$$73})};exportProperty(xdata.util.ObjectMap.prototype,"put",xdata.util.ObjectMap.prototype.put);
xdata.util.ObjectMap.prototype.remove=function(key$$20){var keyHash$$1=xdata.util.computeHashCode(key$$20);var bucket$$2=this._buckets[keyHash$$1];if(!bucket$$2)return undefined;var i$$21=0;for(;i$$21<bucket$$2.length;i$$21++){var entry$$7=bucket$$2[i$$21];if(xdata.util.equal(key$$20,entry$$7.key)){if(bucket$$2.length>1)bucket$$2.splice(i$$21,1);else delete this._buckets[keyHash$$1];return entry$$7.value}}};exportProperty(xdata.util.ObjectMap.prototype,"remove",xdata.util.ObjectMap.prototype.remove);xdata.util.ObjectCache=function(factoryFunction){this._map=new xdata.util.ObjectMap;this._factoryFunction=factoryFunction};exportSymbol("xdata.util.ObjectCache",xdata.util.ObjectCache);xdata.util.ObjectCache.prototype.clear=function(){this._map.clear()};exportProperty(xdata.util.ObjectCache.prototype,"clear",xdata.util.ObjectCache.prototype.clear);
xdata.util.ObjectCache.prototype.get=function(key$$21){var value$$74=this._map.get(key$$21);if(value$$74===undefined){value$$74=this._factoryFunction(key$$21);this._map.put(key$$21,value$$74)}return value$$74};exportProperty(xdata.util.ObjectCache.prototype,"get",xdata.util.ObjectCache.prototype.get);xdata.core.ResultProcessor=function(db$$10,baseElement$$8,changeTrackerMethodName){this._db=db$$10;this._baseElement=baseElement$$8;this._changeTrackerMethodName=changeTrackerMethodName;this._dispatcher=null;this._extractors=null};
xdata.core.ResultProcessor.prototype.addChangeTracker=function(changeTracker$$6){if(!this._changeTrackerMethodName)return;if(!this._dispatcher)this._dispatcher=new xdata.core.ChangeTrackerDispatcher(this._changeTrackerMethodName);var added=this._dispatcher.add(changeTracker$$6);if(added)this._invalidateExtractors()};xdata.core.ResultProcessor.prototype.removeChangeTracker=function(changeTracker$$7){if(!this._dispatcher)return;var removed=this._dispatcher.remove(changeTracker$$7);if(removed)this._invalidateExtractors()};
xdata.core.ResultProcessor.prototype.clearChangeTrackers=function(){if(!this._dispatcher)return;var cleared=this._dispatcher.clear();if(cleared)this._invalidateExtractors()};xdata.core.ResultProcessor.prototype.getVoidExtractor=function(){return this._retrieveExtractor(xdata.core.ResultProcessor._VoidExtractor,undefined)};xdata.core.ResultProcessor.prototype.getFlagExtractor=function(){return this._retrieveExtractor(xdata.core.ResultProcessor._FlagExtractor,undefined)};
xdata.core.ResultProcessor.prototype.getCountExtractor=function(){return this._retrieveExtractor(xdata.core.ResultProcessor._CountExtractor,undefined)};xdata.core.ResultProcessor.prototype.getSingletonExtractor=function(outputs$$1){return this._retrieveExtractor(xdata.core.ResultProcessor._SingletonExtractor,outputs$$1)};xdata.core.ResultProcessor.prototype.getListExtractor=function(outputs$$2){return this._retrieveExtractor(xdata.core.ResultProcessor._ListExtractor,outputs$$2)};
xdata.core.ResultProcessor.prototype.getCursorExtractor=function(outputs$$3){return this._retrieveExtractor(xdata.core.ResultProcessor._CursorExtractor,outputs$$3)};xdata.core.ResultProcessor.prototype._retrieveExtractor=function(ctor$$3,outputs$$4){if(!this._extractors)this._extractors=new xdata.util.ObjectCache(this._createExtractor.bind(this));return this._extractors.get({ctorKey:ctor$$3["key"],outputs:outputs$$4})};xdata.core.ResultProcessor.prototype._invalidateExtractors=function(){if(this._extractors)this._extractors.clear()};
xdata.core.ResultProcessor._ExtractorDescr;
xdata.core.ResultProcessor.prototype._createExtractor=function(descr){var ctor$$4=xdata.core.ResultProcessor._EXTRACTOR_CTORS[descr.ctorKey];var outputs$$5=descr.outputs;var dispatcher=this._dispatcher;var compiledOutputs=null;var outputValues$$1=null;if(outputs$$5||dispatcher&&!dispatcher.isEmpty()){var outputsByTargetName$$1={};if(outputs$$5)outputsByTargetName$$1[xdata.core.ResultProcessor._OUTPUT_TARGET_NAME]=outputs$$5;if(dispatcher)xdata.util.assignObject(outputsByTargetName$$1,dispatcher.getOutputsByTargetName());
outputValues$$1=new xdata.core.OutputValues;compiledOutputs=new xdata.core.CompiledOutputs(this._db,this._baseElement,outputsByTargetName$$1,outputValues$$1)}return new ctor$$4(compiledOutputs,outputValues$$1,dispatcher)};xdata.core.ResultProcessor._OUTPUT_TARGET_NAME="output";xdata.core.ResultProcessor._AbstractExtractor=function(compiledOutputs$$1,outputValues$$2,dispatcher$$1){this._compiledOutputs=compiledOutputs$$1;this._outputValues=outputValues$$2;this._dispatcher=dispatcher$$1};
xdata.core.ResultProcessor._AbstractExtractor.prototype.getProviderOutputs=function(){if(this._compiledOutputs)return this._compiledOutputs.getProviderOutputs();return[]};xdata.core.ResultProcessor._AbstractExtractor.prototype.extract=ABSTRACT_METHOD;xdata.core.ResultProcessor._AbstractExtractor.prototype.processForCursorResult=function(providerResultPromise$$2){return new xdata.core.ResultCursor(providerResultPromise$$2,this._prcessResultElement,this)};
xdata.core.ResultProcessor._AbstractExtractor.prototype.processAllForFullResult=function(providerResultPromise$$3,builder){var $jscomp$this$$7=this;return providerResultPromise$$3.then(function(providerResult$$3){switch(typeof providerResult$$3){case "boolean":case "number":return builder.buildPrimitive(providerResult$$3);case "object":break;default:throw new Error("Unexpected provider result type");}var providerMetadata$$4=xdata.core.extractProviderMetadata(providerResult$$3);if(Array.isArray(providerResult$$3)){var resultIndex=
0;for(;resultIndex<providerResult$$3.length;resultIndex++)builder.add($jscomp$this$$7._prcessResultElement(providerResult$$3[resultIndex]));return builder.build(providerMetadata$$4)}else if("next"in providerResult$$3)return(new Promise(function(resolve){function consume(cursor){var $jscomp$this$$8=this;Promise.resolve(cursor.next()).then(function(iterElement$$1){if(iterElement$$1.done)resolve();else{builder.add($jscomp$this$$8._prcessResultElement(iterElement$$1.value));consume(cursor)}})}consume(providerResult$$3)})).then(function(){return builder.build(providerMetadata$$4)});
else{builder.add($jscomp$this$$7._prcessResultElement(providerResult$$3));return builder.build(providerMetadata$$4)}})};
xdata.core.ResultProcessor._AbstractExtractor.prototype.processOneForFullResult=function(providerResultPromise$$4,builder$$1){var $jscomp$this$$9=this;return providerResultPromise$$4.then(function(providerResult$$4){switch(typeof providerResult$$4){case "boolean":case "number":return builder$$1.buildPrimitive(providerResult$$4);case "object":break;default:throw new Error("Unexpected provider result type");}if(Array.isArray(providerResult$$4)){if(providerResult$$4.length>0)builder$$1.add($jscomp$this$$9._prcessResultElement(providerResult$$4[0]));
return builder$$1.build(null)}else if("next"in providerResult$$4)return Promise.resolve(providerResult$$4.next()).then(function(firstIterElement){if(!firstIterElement.done)builder$$1.add($jscomp$this$$9._prcessResultElement(firstIterElement.value));return builder$$1.build(null)});else{builder$$1.add($jscomp$this$$9._prcessResultElement(providerResult$$4));return builder$$1.build(null)}})};xdata.core.ResultProcessor._AbstractExtractor.FullResultBuilder=function(){};
xdata.core.ResultProcessor._AbstractExtractor.FullResultBuilder.prototype.add=function(elementPromise){};xdata.core.ResultProcessor._AbstractExtractor.FullResultBuilder.prototype.build=function(providerMetadata$$5){};xdata.core.ResultProcessor._AbstractExtractor.FullResultBuilder.prototype.buildPrimitive=function(primitiveProviderResult){};
xdata.core.ResultProcessor._AbstractExtractor.prototype._prcessResultElement=function(providerResultElement){var $jscomp$this$$10=this;if(this._outputValues)return this._outputValues.prepareTargets(providerResultElement).then(function(targets$$1){$jscomp$this$$10._dispatcher&&$jscomp$this$$10._dispatcher.notify(targets$$1);return targets$$1[xdata.core.ResultProcessor._OUTPUT_TARGET_NAME]});this._dispatcher&&this._dispatcher.notify({});return Promise.resolve()};
xdata.core.ResultProcessor._VoidExtractor=function(compiledOutputs$$2,outputValues$$3,dispatcher$$2){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$2,outputValues$$3,dispatcher$$2)};extendConstructor(xdata.core.ResultProcessor._VoidExtractor,xdata.core.ResultProcessor._AbstractExtractor);
xdata.core.ResultProcessor._VoidExtractor.prototype.extract=function(providerResultPromise$$5){return this.processAllForFullResult(providerResultPromise$$5,{add:function(elementPromise$$1){},build:function(providerMetadata$$6){return undefined},buildPrimitive:function(){return undefined}})};xdata.core.ResultProcessor._FlagExtractor=function(compiledOutputs$$3,outputValues$$4,dispatcher$$3){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$3,outputValues$$4,dispatcher$$3)};
extendConstructor(xdata.core.ResultProcessor._FlagExtractor,xdata.core.ResultProcessor._AbstractExtractor);
xdata.core.ResultProcessor._FlagExtractor.prototype.extract=function(providerResultPromise$$6){var affected=false;return this.processAllForFullResult(providerResultPromise$$6,{add:function(elementPromise$$2){affected=true},build:function(providerMetadata$$7){return affected},buildPrimitive:function(primitiveProviderResult$$1){if(primitiveProviderResult$$1==="number")return primitiveProviderResult$$1>0;return!!primitiveProviderResult$$1}})};
xdata.core.ResultProcessor._CountExtractor=function(compiledOutputs$$4,outputValues$$5,dispatcher$$4){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$4,outputValues$$5,dispatcher$$4)};extendConstructor(xdata.core.ResultProcessor._CountExtractor,xdata.core.ResultProcessor._AbstractExtractor);
xdata.core.ResultProcessor._CountExtractor.prototype.extract=function(providerResultPromise$$7){var count$$4=0;return this.processAllForFullResult(providerResultPromise$$7,{add:function(elementPromise$$3){count$$4++},build:function(providerMetadata$$8){return count$$4},buildPrimitive:function(primitiveProviderResult$$2){if(typeof primitiveProviderResult$$2!=="number")throw new Error("Provider result not processable as count");return primitiveProviderResult$$2}})};
xdata.core.ResultProcessor._SingletonExtractor=function(compiledOutputs$$5,outputValues$$6,dispatcher$$5){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$5,outputValues$$6,dispatcher$$5)};extendConstructor(xdata.core.ResultProcessor._SingletonExtractor,xdata.core.ResultProcessor._AbstractExtractor);
xdata.core.ResultProcessor._SingletonExtractor.prototype.extract=function(providerResultPromise$$8){var onlyElementPromise=null;return this.processOneForFullResult(providerResultPromise$$8,{add:function(elementPromise$$4){onlyElementPromise=elementPromise$$4},build:function(providerMetadata$$9){return onlyElementPromise||null},buildPrimitive:function(primitiveProviderResult$$3){throw new Error("Provider result not processable as singleton");}})};
xdata.core.ResultProcessor._ListExtractor=function(compiledOutputs$$6,outputValues$$7,dispatcher$$6){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$6,outputValues$$7,dispatcher$$6)};extendConstructor(xdata.core.ResultProcessor._ListExtractor,xdata.core.ResultProcessor._AbstractExtractor);
xdata.core.ResultProcessor._ListExtractor.prototype.extract=function(providerResultPromise$$9){var elementPromises=[];return this.processAllForFullResult(providerResultPromise$$9,{add:function(elementPromise$$5){elementPromises.push(elementPromise$$5)},build:function(providerMetadata$$10){return Promise.all(elementPromises).then(function(elements$$2){return xdata.core.createList(elements$$2,providerMetadata$$10)})},buildPrimitive:function(primitiveProviderResult$$4){throw new Error("Provider result not processable as list");
}})};xdata.core.ResultProcessor._CursorExtractor=function(compiledOutputs$$7,outputValues$$8,dispatcher$$7){xdata.core.ResultProcessor._AbstractExtractor.call(this,compiledOutputs$$7,outputValues$$8,dispatcher$$7)};extendConstructor(xdata.core.ResultProcessor._CursorExtractor,xdata.core.ResultProcessor._AbstractExtractor);xdata.core.ResultProcessor._CursorExtractor.prototype.extract=function(providerResultPromise$$10){return this.processForCursorResult(providerResultPromise$$10)};
xdata.core.ResultProcessor._EXTRACTOR_CTORS=function(){var map={};var count$$5=0;[xdata.core.ResultProcessor._VoidExtractor,xdata.core.ResultProcessor._FlagExtractor,xdata.core.ResultProcessor._CountExtractor,xdata.core.ResultProcessor._SingletonExtractor,xdata.core.ResultProcessor._ListExtractor,xdata.core.ResultProcessor._CursorExtractor].forEach(function(ctor$$5){ctor$$5["key"]="extractor"+count$$5++;map[ctor$$5["key"]]=ctor$$5});return map}();xdata.core.AbstractQuery=function(db$$11,erName,changeTrackerMethodName$$1){this.db=db$$11;this._baseElement=db$$11.getSchema().getEntityOrRelationship(erName);this._baseEntity=null;this._baseRelationship=null;if(this._baseElement instanceof xdata.schema.Entity)this._baseEntity=this._baseElement;else this._baseRelationship=this._baseElement;this._baseElementMappedName=xdata.core.AbstractQuery._computeStoreOrRelationName(this._baseElement);this._resultProcessor=new xdata.core.ResultProcessor(this.db,
this._baseElement,changeTrackerMethodName$$1);this._inputValues=new xdata.core.InputValues};exportSymbol("xdata.core.AbstractQuery",xdata.core.AbstractQuery);xdata.core.AbstractQuery._computeStoreOrRelationName=function(entityOrRelationship){if(entityOrRelationship instanceof xdata.schema.Entity)return xdata.core.SchemaMapper.getStoreName(entityOrRelationship);else return xdata.core.SchemaMapper.getRelationName(entityOrRelationship)};xdata.core.AbstractQuery.prototype.addChangeTracker=function(changeTracker$$8){this._resultProcessor.addChangeTracker(changeTracker$$8)};
exportProperty(xdata.core.AbstractQuery.prototype,"addChangeTracker",xdata.core.AbstractQuery.prototype.addChangeTracker);xdata.core.AbstractQuery.prototype.removeChangeTracker=function(changeTracker$$9){this._resultProcessor.removeChangeTracker(changeTracker$$9)};exportProperty(xdata.core.AbstractQuery.prototype,"removeChangeTracker",xdata.core.AbstractQuery.prototype.removeChangeTracker);xdata.core.AbstractQuery.prototype.clearChangeTrackers=function(){this._resultProcessor.clearChangeTrackers()};
exportProperty(xdata.core.AbstractQuery.prototype,"clearChangeTrackers",xdata.core.AbstractQuery.prototype.clearChangeTrackers);xdata.core.AbstractQuery.prototype.hasBaseEntity=function(){return!!this._baseEntity};xdata.core.AbstractQuery.prototype.getBaseEntity=function(){if(DEBUG&&!this._baseEntity)throw new Error("Base entity is not available");return this._baseEntity};
xdata.core.AbstractQuery.prototype.getBaseRelationship=function(){if(DEBUG&&!this._baseRelationship)throw new Error("Base relationship is not available");return this._baseRelationship};xdata.core.AbstractQuery.prototype.getBaseElementMappedName=function(){return this._baseElementMappedName};
xdata.core.AbstractQuery.prototype.createEntityInputsCompiler=function(inputs$$7){if(!(this._baseElement instanceof xdata.schema.Entity))throw new Error("Entity inputs are supported only on entity-based queries");return new xdata.core.EntityInputsCompiler(this.db,this._baseElement,inputs$$7,this._inputValues)};xdata.core.AbstractQuery.prototype.createInputsCompiler=function(inputs$$8){return new xdata.core.InputsCompiler(this.db,this._baseElement,inputs$$8,this._inputValues)};
xdata.core.AbstractQuery.prototype.createFilterCompiler=function(filterExpr$$2){return new xdata.core.FilterCompiler(this.db,this._baseElement,filterExpr$$2,this._inputValues)};xdata.core.AbstractQuery.prototype.compileOrder=function(orderExpr$$1){return new xdata.core.CompiledOrder(this.db,this._baseElement,orderExpr$$1)};xdata.core.AbstractQuery.prototype.prepareInputParameters=function(parameters$$5){return this._inputValues.prepareObject(parameters$$5)};
xdata.core.AbstractQuery.prototype.getVoidExtractor=function(){return this._resultProcessor.getVoidExtractor()};xdata.core.AbstractQuery.prototype.getFlagExtractor=function(){return this._resultProcessor.getFlagExtractor()};xdata.core.AbstractQuery.prototype.getCountExtractor=function(){return this._resultProcessor.getCountExtractor()};xdata.core.AbstractQuery.prototype.getSingletonExtractor=function(outputs$$6){return this._resultProcessor.getSingletonExtractor(outputs$$6)};
xdata.core.AbstractQuery.prototype.getListExtractor=function(outputs$$7){return this._resultProcessor.getListExtractor(outputs$$7)};xdata.core.AbstractQuery.prototype.getCursorExtractor=function(outputs$$8){return this._resultProcessor.getCursorExtractor(outputs$$8)};xdata.DeleteQuery=function(){};exportSymbol("xdata.DeleteQuery",xdata.DeleteQuery);xdata.DeleteQuery.Options=function(){};exportProperty(xdata.DeleteQuery,"Options",xdata.DeleteQuery.Options);xdata.DeleteQuery.Options.prototype.entityInputs;exportProperty(xdata.DeleteQuery.Options.prototype,"entityInputs",xdata.DeleteQuery.Options.prototype.entityInputs);xdata.DeleteQuery.Options.prototype.filter;exportProperty(xdata.DeleteQuery.Options.prototype,"filter",xdata.DeleteQuery.Options.prototype.filter);
xdata.DeleteQuery.prototype.execute=function(tx$$1,parameters$$6){};exportProperty(xdata.DeleteQuery.prototype,"execute",xdata.DeleteQuery.prototype.execute);xdata.DeleteQuery.prototype.executeGetChanged=function(tx$$2,parameters$$7){};exportProperty(xdata.DeleteQuery.prototype,"executeGetChanged",xdata.DeleteQuery.prototype.executeGetChanged);xdata.DeleteQuery.prototype.executeGetCount=function(tx$$3,parameters$$8){};exportProperty(xdata.DeleteQuery.prototype,"executeGetCount",xdata.DeleteQuery.prototype.executeGetCount);
xdata.DeleteQuery.prototype.executeGetKeys=function(tx$$4,parameters$$9){};exportProperty(xdata.DeleteQuery.prototype,"executeGetKeys",xdata.DeleteQuery.prototype.executeGetKeys);xdata.InsertQuery=function(){};exportSymbol("xdata.InsertQuery",xdata.InsertQuery);xdata.InsertQuery.Options=function(){};exportProperty(xdata.InsertQuery,"Options",xdata.InsertQuery.Options);xdata.InsertQuery.Options.prototype.entityInputs;exportProperty(xdata.InsertQuery.Options.prototype,"entityInputs",xdata.InsertQuery.Options.prototype.entityInputs);xdata.InsertQuery.Options.prototype.inserts;exportProperty(xdata.InsertQuery.Options.prototype,"inserts",xdata.InsertQuery.Options.prototype.inserts);
xdata.InsertQuery.prototype.execute=function(tx$$5,parameters$$10){};exportProperty(xdata.InsertQuery.prototype,"execute",xdata.InsertQuery.prototype.execute);xdata.InsertQuery.prototype.executeGetChanged=function(tx$$6,parameters$$11){};exportProperty(xdata.InsertQuery.prototype,"executeGetChanged",xdata.InsertQuery.prototype.executeGetChanged);xdata.InsertQuery.prototype.executeGetKey=function(tx$$7,parameters$$12){};exportProperty(xdata.InsertQuery.prototype,"executeGetKey",xdata.InsertQuery.prototype.executeGetKey);xdata.Order=function(){};exportSymbol("xdata.Order",xdata.Order);xdata.Order.GenericTerm=function(){};exportProperty(xdata.Order,"GenericTerm",xdata.Order.GenericTerm);xdata.Order.GenericTerm.prototype.property;exportProperty(xdata.Order.GenericTerm.prototype,"property",xdata.Order.GenericTerm.prototype.property);xdata.Order.GenericTerm.prototype.descending;exportProperty(xdata.Order.GenericTerm.prototype,"descending",xdata.Order.GenericTerm.prototype.descending);xdata.Order.SingleAscendingTerm;
exportProperty(xdata.Order,"SingleAscendingTerm",xdata.Order.SingleAscendingTerm);xdata.Order.Term;exportProperty(xdata.Order,"Term",xdata.Order.Term);xdata.SelectQuery=function(){};exportSymbol("xdata.SelectQuery",xdata.SelectQuery);xdata.SelectQuery.Options=function(){};exportProperty(xdata.SelectQuery,"Options",xdata.SelectQuery.Options);xdata.SelectQuery.Options.prototype.entityInputs;exportProperty(xdata.SelectQuery.Options.prototype,"entityInputs",xdata.SelectQuery.Options.prototype.entityInputs);xdata.SelectQuery.Options.prototype.distinct;exportProperty(xdata.SelectQuery.Options.prototype,"distinct",xdata.SelectQuery.Options.prototype.distinct);
xdata.SelectQuery.Options.prototype.output;exportProperty(xdata.SelectQuery.Options.prototype,"output",xdata.SelectQuery.Options.prototype.output);xdata.SelectQuery.Options.prototype.filter;exportProperty(xdata.SelectQuery.Options.prototype,"filter",xdata.SelectQuery.Options.prototype.filter);xdata.SelectQuery.Options.prototype.order;exportProperty(xdata.SelectQuery.Options.prototype,"order",xdata.SelectQuery.Options.prototype.order);xdata.SelectQuery.Options.prototype.limit;
exportProperty(xdata.SelectQuery.Options.prototype,"limit",xdata.SelectQuery.Options.prototype.limit);xdata.SelectQuery.prototype.query=function(tx$$8,parameters$$13){};exportProperty(xdata.SelectQuery.prototype,"query",xdata.SelectQuery.prototype.query);xdata.SelectQuery.prototype.queryAll=function(tx$$9,parameters$$14){};exportProperty(xdata.SelectQuery.prototype,"queryAll",xdata.SelectQuery.prototype.queryAll);xdata.SelectQuery.prototype.queryOne=function(tx$$10,parameters$$15){};
exportProperty(xdata.SelectQuery.prototype,"queryOne",xdata.SelectQuery.prototype.queryOne);xdata.UpdateQuery=function(){};exportSymbol("xdata.UpdateQuery",xdata.UpdateQuery);xdata.UpdateQuery.Options=function(){};exportProperty(xdata.UpdateQuery,"Options",xdata.UpdateQuery.Options);xdata.UpdateQuery.Options.prototype.entityInputs;exportProperty(xdata.UpdateQuery.Options.prototype,"entityInputs",xdata.UpdateQuery.Options.prototype.entityInputs);xdata.UpdateQuery.Options.prototype.updates;exportProperty(xdata.UpdateQuery.Options.prototype,"updates",xdata.UpdateQuery.Options.prototype.updates);
xdata.UpdateQuery.Options.prototype.filter;exportProperty(xdata.UpdateQuery.Options.prototype,"filter",xdata.UpdateQuery.Options.prototype.filter);xdata.UpdateQuery.prototype.execute=function(tx$$11,parameters$$16){};exportProperty(xdata.UpdateQuery.prototype,"execute",xdata.UpdateQuery.prototype.execute);xdata.UpdateQuery.prototype.executeGetChanged=function(tx$$12,parameters$$17){};exportProperty(xdata.UpdateQuery.prototype,"executeGetChanged",xdata.UpdateQuery.prototype.executeGetChanged);
xdata.UpdateQuery.prototype.executeGetCount=function(tx$$13,parameters$$18){};exportProperty(xdata.UpdateQuery.prototype,"executeGetCount",xdata.UpdateQuery.prototype.executeGetCount);xdata.UpdateQuery.prototype.executeGetKeys=function(tx$$14,parameters$$19){};exportProperty(xdata.UpdateQuery.prototype,"executeGetKeys",xdata.UpdateQuery.prototype.executeGetKeys);xdata.Transaction=function(){};exportSymbol("xdata.Transaction",xdata.Transaction);xdata.Transaction.Options=function(){};exportProperty(xdata.Transaction,"Options",xdata.Transaction.Options);xdata.Transaction.Options.prototype.readOnly;exportProperty(xdata.Transaction.Options.prototype,"readOnly",xdata.Transaction.Options.prototype.readOnly);xdata.Transaction.Options.prototype.atomic;exportProperty(xdata.Transaction.Options.prototype,"atomic",xdata.Transaction.Options.prototype.atomic);
xdata.Transaction.prototype.select=function(erName$$1,options$$4,parameters$$20){};exportProperty(xdata.Transaction.prototype,"select",xdata.Transaction.prototype.select);xdata.Transaction.prototype.selectAll=function(erName$$2,options$$5,parameters$$21){};exportProperty(xdata.Transaction.prototype,"selectAll",xdata.Transaction.prototype.selectAll);xdata.Transaction.prototype.selectOne=function(erName$$3,options$$6,parameters$$22){};exportProperty(xdata.Transaction.prototype,"selectOne",xdata.Transaction.prototype.selectOne);
xdata.Transaction.prototype.insert=function(erName$$4,options$$7,parameters$$23){};exportProperty(xdata.Transaction.prototype,"insert",xdata.Transaction.prototype.insert);xdata.Transaction.prototype.insertGetChanged=function(erName$$5,options$$8,parameters$$24){};exportProperty(xdata.Transaction.prototype,"insertGetChanged",xdata.Transaction.prototype.insertGetChanged);xdata.Transaction.prototype.insertGetKey=function(erName$$6,options$$9,parameters$$25){};
exportProperty(xdata.Transaction.prototype,"insertGetKey",xdata.Transaction.prototype.insertGetKey);xdata.Transaction.prototype.update=function(erName$$7,options$$10,parameters$$26){};exportProperty(xdata.Transaction.prototype,"update",xdata.Transaction.prototype.update);xdata.Transaction.prototype.updateGetChanged=function(erName$$8,options$$11,parameters$$27){};exportProperty(xdata.Transaction.prototype,"updateGetChanged",xdata.Transaction.prototype.updateGetChanged);
xdata.Transaction.prototype.updateGetCount=function(erName$$9,options$$12,parameters$$28){};exportProperty(xdata.Transaction.prototype,"updateGetCount",xdata.Transaction.prototype.updateGetCount);xdata.Transaction.prototype.updateGetKeys=function(erName$$10,options$$13,parameters$$29){};exportProperty(xdata.Transaction.prototype,"updateGetKeys",xdata.Transaction.prototype.updateGetKeys);xdata.Transaction.prototype["delete"]=function(erName$$11,options$$14,parameters$$30){};
xdata.Transaction.prototype.deleteGetChanged=function(erName$$12,options$$15,parameters$$31){};exportProperty(xdata.Transaction.prototype,"deleteGetChanged",xdata.Transaction.prototype.deleteGetChanged);xdata.Transaction.prototype.deleteGetCount=function(erName$$13,options$$16,parameters$$32){};exportProperty(xdata.Transaction.prototype,"deleteGetCount",xdata.Transaction.prototype.deleteGetCount);xdata.Transaction.prototype.deleteGetKeys=function(erName$$14,options$$17,parameters$$33){};
exportProperty(xdata.Transaction.prototype,"deleteGetKeys",xdata.Transaction.prototype.deleteGetKeys);xdata.Transaction.prototype.resolve=function(){};exportProperty(xdata.Transaction.prototype,"resolve",xdata.Transaction.prototype.resolve);xdata.Session=function(){};exportSymbol("xdata.Session",xdata.Session);xdata.Session.Options=function(){};exportProperty(xdata.Session,"Options",xdata.Session.Options);xdata.Session.Options.prototype.autoCreate;exportProperty(xdata.Session.Options.prototype,"autoCreate",xdata.Session.Options.prototype.autoCreate);xdata.Session.Options.prototype.username;exportProperty(xdata.Session.Options.prototype,"username",xdata.Session.Options.prototype.username);xdata.Session.Options.prototype.password;
exportProperty(xdata.Session.Options.prototype,"password",xdata.Session.Options.prototype.password);xdata.Session.prototype.createTransaction=function(options$$18){};exportProperty(xdata.Session.prototype,"createTransaction",xdata.Session.prototype.createTransaction);xdata.Database=function(){};exportSymbol("xdata.Database",xdata.Database);xdata.Database.prototype.getVersion=function(){};exportProperty(xdata.Database.prototype,"getVersion",xdata.Database.prototype.getVersion);xdata.Database.prototype.getSchema=function(){};exportProperty(xdata.Database.prototype,"getSchema",xdata.Database.prototype.getSchema);xdata.Database.prototype.createSession=function(concreteDatabaseName,options$$19){};exportProperty(xdata.Database.prototype,"createSession",xdata.Database.prototype.createSession);
xdata.Database.prototype.upgradeVersion=function(concreteDatabaseName$$1,oldSchemaFactory){};exportProperty(xdata.Database.prototype,"upgradeVersion",xdata.Database.prototype.upgradeVersion);xdata.Database.prototype.prepareSelect=function(erName$$15,options$$20){};exportProperty(xdata.Database.prototype,"prepareSelect",xdata.Database.prototype.prepareSelect);xdata.Database.prototype.prepareInsert=function(erName$$16,options$$21){};exportProperty(xdata.Database.prototype,"prepareInsert",xdata.Database.prototype.prepareInsert);
xdata.Database.prototype.prepareUpdate=function(erName$$17,options$$22){};exportProperty(xdata.Database.prototype,"prepareUpdate",xdata.Database.prototype.prepareUpdate);xdata.Database.prototype.prepareDelete=function(erName$$18,options$$23){};exportProperty(xdata.Database.prototype,"prepareDelete",xdata.Database.prototype.prepareDelete);xdata.Database.prototype.attachSession=function(lowLevelConn){};exportProperty(xdata.Database.prototype,"attachSession",xdata.Database.prototype.attachSession);
xdata.Database.prototype.attachTransaction=function(lowLevelTx){};exportProperty(xdata.Database.prototype,"attachTransaction",xdata.Database.prototype.attachTransaction);xdata.Database.prototype.addListener=function(listener$$38){};exportProperty(xdata.Database.prototype,"addListener",xdata.Database.prototype.addListener);xdata.Database.prototype.removeListener=function(listener$$39){};exportProperty(xdata.Database.prototype,"removeListener",xdata.Database.prototype.removeListener);xdata.ProviderFeature={ATOMIC_TRANSACTIONS:"atomicTransactions"};exportSymbol("xdata.ProviderFeature",xdata.ProviderFeature);xdata.ProviderListener=function(){};exportSymbol("xdata.ProviderListener",xdata.ProviderListener);xdata.ProviderListener.prototype.begunTransaction=function(event){};exportProperty(xdata.ProviderListener.prototype,"begunTransaction",xdata.ProviderListener.prototype.begunTransaction);xdata.ProviderListener.prototype.resolvedTransaction=function(event$$1){};exportProperty(xdata.ProviderListener.prototype,"resolvedTransaction",xdata.ProviderListener.prototype.resolvedTransaction);
xdata.ProviderListener.prototype.executingCommand=function(event$$2){};exportProperty(xdata.ProviderListener.prototype,"executingCommand",xdata.ProviderListener.prototype.executingCommand);xdata.ProviderListener.prototype.executedCommand=function(event$$3){};exportProperty(xdata.ProviderListener.prototype,"executedCommand",xdata.ProviderListener.prototype.executedCommand);xdata.ProviderSchema=function(){};exportSymbol("xdata.ProviderSchema",xdata.ProviderSchema);xdata.ProviderSchema.prototype.stores;exportProperty(xdata.ProviderSchema.prototype,"stores",xdata.ProviderSchema.prototype.stores);xdata.ProviderSchema.prototype.relations;exportProperty(xdata.ProviderSchema.prototype,"relations",xdata.ProviderSchema.prototype.relations);xdata.ProviderSchema.Store=function(){};exportProperty(xdata.ProviderSchema,"Store",xdata.ProviderSchema.Store);xdata.ProviderSchema.Store.prototype.name;
exportProperty(xdata.ProviderSchema.Store.prototype,"name",xdata.ProviderSchema.Store.prototype.name);xdata.ProviderSchema.Store.prototype.identities;exportProperty(xdata.ProviderSchema.Store.prototype,"identities",xdata.ProviderSchema.Store.prototype.identities);xdata.ProviderSchema.Store.prototype.inputs;exportProperty(xdata.ProviderSchema.Store.prototype,"inputs",xdata.ProviderSchema.Store.prototype.inputs);xdata.ProviderSchema.Store.prototype.fields;
exportProperty(xdata.ProviderSchema.Store.prototype,"fields",xdata.ProviderSchema.Store.prototype.fields);xdata.ProviderSchema.Store.prototype.indexes;exportProperty(xdata.ProviderSchema.Store.prototype,"indexes",xdata.ProviderSchema.Store.prototype.indexes);xdata.ProviderSchema.Input=function(){};exportProperty(xdata.ProviderSchema,"Input",xdata.ProviderSchema.Input);xdata.ProviderSchema.Input.prototype.name;exportProperty(xdata.ProviderSchema.Input.prototype,"name",xdata.ProviderSchema.Input.prototype.name);
xdata.ProviderSchema.Input.prototype.identities;exportProperty(xdata.ProviderSchema.Input.prototype,"identities",xdata.ProviderSchema.Input.prototype.identities);xdata.ProviderSchema.Input.prototype.type;exportProperty(xdata.ProviderSchema.Input.prototype,"type",xdata.ProviderSchema.Input.prototype.type);xdata.ProviderSchema.Field=function(){};exportProperty(xdata.ProviderSchema,"Field",xdata.ProviderSchema.Field);xdata.ProviderSchema.Field.prototype.name;
exportProperty(xdata.ProviderSchema.Field.prototype,"name",xdata.ProviderSchema.Field.prototype.name);xdata.ProviderSchema.Field.prototype.identities;exportProperty(xdata.ProviderSchema.Field.prototype,"identities",xdata.ProviderSchema.Field.prototype.identities);xdata.ProviderSchema.Field.prototype.type;exportProperty(xdata.ProviderSchema.Field.prototype,"type",xdata.ProviderSchema.Field.prototype.type);xdata.ProviderSchema.Field.prototype.key;
exportProperty(xdata.ProviderSchema.Field.prototype,"key",xdata.ProviderSchema.Field.prototype.key);xdata.ProviderSchema.Relation=function(){};exportProperty(xdata.ProviderSchema,"Relation",xdata.ProviderSchema.Relation);xdata.ProviderSchema.Relation.prototype.name;exportProperty(xdata.ProviderSchema.Relation.prototype,"name",xdata.ProviderSchema.Relation.prototype.name);xdata.ProviderSchema.Relation.prototype.identities;exportProperty(xdata.ProviderSchema.Relation.prototype,"identities",xdata.ProviderSchema.Relation.prototype.identities);
xdata.ProviderSchema.Relation.prototype.end1;exportProperty(xdata.ProviderSchema.Relation.prototype,"end1",xdata.ProviderSchema.Relation.prototype.end1);xdata.ProviderSchema.Relation.prototype.end2;exportProperty(xdata.ProviderSchema.Relation.prototype,"end2",xdata.ProviderSchema.Relation.prototype.end2);xdata.ProviderSchema.RelationEnd=function(){};exportProperty(xdata.ProviderSchema,"RelationEnd",xdata.ProviderSchema.RelationEnd);xdata.ProviderSchema.RelationEnd.prototype.storeName;
exportProperty(xdata.ProviderSchema.RelationEnd.prototype,"storeName",xdata.ProviderSchema.RelationEnd.prototype.storeName);xdata.ProviderSchema.RelationEnd.prototype.name;exportProperty(xdata.ProviderSchema.RelationEnd.prototype,"name",xdata.ProviderSchema.RelationEnd.prototype.name);xdata.ProviderSchema.RelationEnd.prototype.many;exportProperty(xdata.ProviderSchema.RelationEnd.prototype,"many",xdata.ProviderSchema.RelationEnd.prototype.many);xdata.ProviderSchema.RelationEnd.prototype.innerName;
exportProperty(xdata.ProviderSchema.RelationEnd.prototype,"innerName",xdata.ProviderSchema.RelationEnd.prototype.innerName);xdata.ProviderSchema.Index=function(){};exportProperty(xdata.ProviderSchema,"Index",xdata.ProviderSchema.Index);xdata.ProviderSchema.Index.prototype.unique;exportProperty(xdata.ProviderSchema.Index.prototype,"unique",xdata.ProviderSchema.Index.prototype.unique);xdata.ProviderSchema.Index.prototype.fieldNames;exportProperty(xdata.ProviderSchema.Index.prototype,"fieldNames",xdata.ProviderSchema.Index.prototype.fieldNames);
xdata.ProviderSchema.Element=function(){};exportProperty(xdata.ProviderSchema,"Element",xdata.ProviderSchema.Element);xdata.ProviderSchema.Element.prototype.properties;exportProperty(xdata.ProviderSchema.Element.prototype,"properties",xdata.ProviderSchema.Element.prototype.properties);xdata.Provider=function(){};exportSymbol("xdata.Provider",xdata.Provider);xdata.Provider.prototype.createDatabase=function(version$$6,schema$$2){};exportProperty(xdata.Provider.prototype,"createDatabase",xdata.Provider.prototype.createDatabase);xdata.Provider.prototype.hasFeature=function(feature$$4){};exportProperty(xdata.Provider.prototype,"hasFeature",xdata.Provider.prototype.hasFeature);xdata.Provider.FilterExpression=function(){};exportProperty(xdata.Provider,"FilterExpression",xdata.Provider.FilterExpression);
xdata.Provider.FilterTerm=function(){};exportProperty(xdata.Provider,"FilterTerm",xdata.Provider.FilterTerm);xdata.Provider.FilterTerm.prototype.fieldPath;exportProperty(xdata.Provider.FilterTerm.prototype,"fieldPath",xdata.Provider.FilterTerm.prototype.fieldPath);xdata.Provider.FilterTerm.prototype.operator;exportProperty(xdata.Provider.FilterTerm.prototype,"operator",xdata.Provider.FilterTerm.prototype.operator);xdata.Provider.FilterTerm.prototype.valueParameter;
exportProperty(xdata.Provider.FilterTerm.prototype,"valueParameter",xdata.Provider.FilterTerm.prototype.valueParameter);xdata.Provider.FilterTerm.prototype.internalOperator;exportProperty(xdata.Provider.FilterTerm.prototype,"internalOperator",xdata.Provider.FilterTerm.prototype.internalOperator);xdata.Provider.FilterLogicExpression=function(){};exportProperty(xdata.Provider,"FilterLogicExpression",xdata.Provider.FilterLogicExpression);xdata.Provider.FilterLogicExpression.prototype.operator;
exportProperty(xdata.Provider.FilterLogicExpression.prototype,"operator",xdata.Provider.FilterLogicExpression.prototype.operator);xdata.Provider.FilterLogicExpression.prototype.operands;exportProperty(xdata.Provider.FilterLogicExpression.prototype,"operands",xdata.Provider.FilterLogicExpression.prototype.operands);xdata.Provider.OrderTerm=function(){};exportProperty(xdata.Provider,"OrderTerm",xdata.Provider.OrderTerm);xdata.Provider.OrderTerm.prototype.fieldPath;
exportProperty(xdata.Provider.OrderTerm.prototype,"fieldPath",xdata.Provider.OrderTerm.prototype.fieldPath);xdata.Provider.OrderTerm.prototype.descending;exportProperty(xdata.Provider.OrderTerm.prototype,"descending",xdata.Provider.OrderTerm.prototype.descending);xdata.Provider.SelectDescr;exportProperty(xdata.Provider,"SelectDescr",xdata.Provider.SelectDescr);xdata.Provider.InsertDescr;exportProperty(xdata.Provider,"InsertDescr",xdata.Provider.InsertDescr);xdata.Provider.UpdateDescr;
exportProperty(xdata.Provider,"UpdateDescr",xdata.Provider.UpdateDescr);xdata.Provider.DeleteDescr;exportProperty(xdata.Provider,"DeleteDescr",xdata.Provider.DeleteDescr);xdata.Provider.Database=function(){};exportProperty(xdata.Provider,"Database",xdata.Provider.Database);xdata.Provider.Database.prototype.createSession=function(concreteDatabaseName$$2,descr$$1){};exportProperty(xdata.Provider.Database.prototype,"createSession",xdata.Provider.Database.prototype.createSession);
xdata.Provider.Database.prototype.upgradeVersion=function(concreteDatabaseName$$3,schemaFactory){};exportProperty(xdata.Provider.Database.prototype,"upgradeVersion",xdata.Provider.Database.prototype.upgradeVersion);xdata.Provider.Database.prototype.compileSelectCommand=function(descr$$2){};exportProperty(xdata.Provider.Database.prototype,"compileSelectCommand",xdata.Provider.Database.prototype.compileSelectCommand);xdata.Provider.Database.prototype.compileInsertCommand=function(descr$$3){};
exportProperty(xdata.Provider.Database.prototype,"compileInsertCommand",xdata.Provider.Database.prototype.compileInsertCommand);xdata.Provider.Database.prototype.compileInsertCommandOLD=function(descr$$4){};exportProperty(xdata.Provider.Database.prototype,"compileInsertCommandOLD",xdata.Provider.Database.prototype.compileInsertCommandOLD);xdata.Provider.Database.prototype.compileUpdateCommand=function(descr$$5){};exportProperty(xdata.Provider.Database.prototype,"compileUpdateCommand",xdata.Provider.Database.prototype.compileUpdateCommand);
xdata.Provider.Database.prototype.compileUpdateCommandOLD=function(descr$$6){};exportProperty(xdata.Provider.Database.prototype,"compileUpdateCommandOLD",xdata.Provider.Database.prototype.compileUpdateCommandOLD);xdata.Provider.Database.prototype.compileDeleteCommand=function(descr$$7){};exportProperty(xdata.Provider.Database.prototype,"compileDeleteCommand",xdata.Provider.Database.prototype.compileDeleteCommand);xdata.Provider.Database.prototype.attachSession=function(lowLevelConn$$1){};
exportProperty(xdata.Provider.Database.prototype,"attachSession",xdata.Provider.Database.prototype.attachSession);xdata.Provider.Database.prototype.attachTransaction=function(lowLevelTx$$1){};exportProperty(xdata.Provider.Database.prototype,"attachTransaction",xdata.Provider.Database.prototype.attachTransaction);xdata.Provider.Database.prototype.addListener=function(listener$$40){};exportProperty(xdata.Provider.Database.prototype,"addListener",xdata.Provider.Database.prototype.addListener);
xdata.Provider.Database.prototype.removeListener=function(listener$$41){};exportProperty(xdata.Provider.Database.prototype,"removeListener",xdata.Provider.Database.prototype.removeListener);xdata.Provider.SessionDescr;exportProperty(xdata.Provider,"SessionDescr",xdata.Provider.SessionDescr);xdata.Provider.Session=function(){};exportProperty(xdata.Provider,"Session",xdata.Provider.Session);xdata.Provider.Session.prototype.createTransaction=function(descr$$8){};
exportProperty(xdata.Provider.Session.prototype,"createTransaction",xdata.Provider.Session.prototype.createTransaction);xdata.Provider.TransactionDescr;exportProperty(xdata.Provider,"TransactionDescr",xdata.Provider.TransactionDescr);xdata.Provider.Transaction=function(){};exportProperty(xdata.Provider,"Transaction",xdata.Provider.Transaction);xdata.Provider.Transaction.prototype.executeCommand=function(command,parameters$$34,metadataEmbedder){};
exportProperty(xdata.Provider.Transaction.prototype,"executeCommand",xdata.Provider.Transaction.prototype.executeCommand);xdata.Provider.Transaction.prototype.resolve=function(){};exportProperty(xdata.Provider.Transaction.prototype,"resolve",xdata.Provider.Transaction.prototype.resolve);xdata.Provider.Result;exportProperty(xdata.Provider,"Result",xdata.Provider.Result);xdata.Provider.ResultMetadata=function(){};exportProperty(xdata.Provider,"ResultMetadata",xdata.Provider.ResultMetadata);xdata.Provider.ResultMetadata.prototype.totalCount;
exportProperty(xdata.Provider.ResultMetadata.prototype,"totalCount",xdata.Provider.ResultMetadata.prototype.totalCount);xdata.core.DeleteQueryImpl=function(db$$12,erName$$19,options$$24){xdata.core.AbstractQuery.call(this,db$$12,erName$$19,"afterDelete");this._entityInputsCompiler=this._createEntityInputsCompiler(options$$24);this._filterCompiler=this._createFilterCompiler(options$$24)};extendConstructor(xdata.core.DeleteQueryImpl,xdata.core.AbstractQuery);exportSymbol("xdata.core.DeleteQueryImpl",xdata.core.DeleteQueryImpl);
xdata.core.DeleteQueryImpl.prototype._createEntityInputsCompiler=function(options$$25){var entityInputs$$1=options$$25&&options$$25.entityInputs;if(!this.hasBaseEntity()){if(entityInputs$$1&&entityInputs$$1.length>0)throw new Error("Entity inputs are not supported in relationship-based queries");return null}if(entityInputs$$1===undefined)entityInputs$$1=this.getBaseEntity().getInputs().map(function(input$$3){var inputName$$16=input$$3.getName();return{input:inputName$$16,valueInput:inputName$$16}});
return this.createEntityInputsCompiler(entityInputs$$1)};xdata.core.DeleteQueryImpl.prototype._createFilterCompiler=function(options$$26){var filter$$2=options$$26&&options$$26.filter;if(filter$$2===undefined)return null;return this.createFilterCompiler(filter$$2)};
xdata.core.DeleteQueryImpl.prototype._createKeyOutputs=function(){if(this.hasBaseEntity())return this.getBaseEntity().getKeyAttribute().getName();else return[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$3){return entity$$3.getName()+"."+entity$$3.getKeyAttribute().getName()})};xdata.core.DeleteQueryImpl.prototype.execute=function(tx$$15,parameters$$35){return this._doExecute(tx$$15,parameters$$35,this.getVoidExtractor())};
exportProperty(xdata.core.DeleteQueryImpl.prototype,"execute",xdata.core.DeleteQueryImpl.prototype.execute);xdata.core.DeleteQueryImpl.prototype.executeGetChanged=function(tx$$16,parameters$$36){return this._doExecute(tx$$16,parameters$$36,this.getFlagExtractor())};exportProperty(xdata.core.DeleteQueryImpl.prototype,"executeGetChanged",xdata.core.DeleteQueryImpl.prototype.executeGetChanged);
xdata.core.DeleteQueryImpl.prototype.executeGetCount=function(tx$$17,parameters$$37){return this._doExecute(tx$$17,parameters$$37,this.getCountExtractor())};exportProperty(xdata.core.DeleteQueryImpl.prototype,"executeGetCount",xdata.core.DeleteQueryImpl.prototype.executeGetCount);xdata.core.DeleteQueryImpl.prototype.executeGetKeys=function(tx$$18,parameters$$38){return this._doExecute(tx$$18,parameters$$38,this.getListExtractor(this._createKeyOutputs()))};
exportProperty(xdata.core.DeleteQueryImpl.prototype,"executeGetKeys",xdata.core.DeleteQueryImpl.prototype.executeGetKeys);
xdata.core.DeleteQueryImpl.prototype._doExecute=function(tx$$19,parameters$$39,extractor){var $jscomp$this$$11=this;return extractor.extract(Promise.resolve().then(function(){return $jscomp$this$$11.prepareInputParameters(parameters$$39)}).then(function(inputParameters){var descr$$9=$jscomp$this$$11._createCommandDescriptor(inputParameters,extractor);if(!descr$$9)return[];var command$$1=$jscomp$this$$11.db.compileDeleteCommand(descr$$9);return tx$$19.executeCommand(command$$1,inputParameters)}))};
xdata.core.DeleteQueryImpl.prototype._createCommandDescriptor=function(parameters$$40,extractor$$1){var providerFiltetExpr;if(this._filterCompiler){var compiledFilter$$1=this._filterCompiler.compile(parameters$$40);if(compiledFilter$$1.isApplicable())if(!compiledFilter$$1.isFixed())providerFiltetExpr=compiledFilter$$1.getProviderExpression();else if(compiledFilter$$1.getFixedResult()===true)providerFiltetExpr=undefined;else return null;else return null}else providerFiltetExpr=undefined;var providerStoreInputs$$2;
if(this._entityInputsCompiler)providerStoreInputs$$2=this._entityInputsCompiler.compile(parameters$$40).getProviderStoreInputs();else providerStoreInputs$$2=[];return{storeOrRelationName:this.getBaseElementMappedName(),storeInputs:providerStoreInputs$$2,filter:providerFiltetExpr,outputs:extractor$$1.getProviderOutputs()}};xdata.core.EventListenerAdapter=function(db$$13,eventListener){this._db=db$$13;this._eventListener=eventListener};xdata.core.EventListenerAdapter._EMPTY_METHOD=function(event$$4){};xdata.core.EventListenerAdapter.prototype.begunTransaction=function(event$$5){if(!("begunTransaction"in this._eventListener)){this.begunTransaction=xdata.core.EventListenerAdapter._EMPTY_METHOD;return}this._eventListener.begunTransaction({database:this._db,readOnly:event$$5.readOnly})};
xdata.core.EventListenerAdapter.prototype.resolvedTransaction=function(event$$6){if(!("resolvedTransaction"in this._eventListener)){this.begunTransaction=xdata.core.EventListenerAdapter._EMPTY_METHOD;return}this._eventListener.resolvedTransaction({database:this._db,readOnly:event$$6.readOnly,committed:event$$6.committed})};
xdata.core.EventListenerAdapter.prototype.executingCommand=function(event$$7){if(!("executingCommand"in this._eventListener)){this.executingCommand=xdata.core.EventListenerAdapter._EMPTY_METHOD;return}this._eventListener.executingCommand({database:this._db,command:event$$7.command,commandParameters:event$$7.commandParameters})};
xdata.core.EventListenerAdapter.prototype.executedCommand=function(event$$8){if(!("executedCommand"in this._eventListener)){this.executedCommand=xdata.core.EventListenerAdapter._EMPTY_METHOD;return}this._eventListener.executedCommand({database:this._db,command:event$$8.command,commandParameters:event$$8.commandParameters,commandError:event$$8.commandError})};xdata.core.InsertQueryImpl=function(db$$14,erName$$20,options$$27){xdata.core.AbstractQuery.call(this,db$$14,erName$$20,"afterInsert");this._entityInputsCompiler=this._createEntityInputsCompiler(options$$27);this._inputsCompiler=this._createInputsCompiler(options$$27)};extendConstructor(xdata.core.InsertQueryImpl,xdata.core.AbstractQuery);exportSymbol("xdata.core.InsertQueryImpl",xdata.core.InsertQueryImpl);
xdata.core.InsertQueryImpl.prototype._createEntityInputsCompiler=function(options$$28){var entityInputs$$2=options$$28&&options$$28.entityInputs;if(!this.hasBaseEntity()){if(entityInputs$$2&&entityInputs$$2.length>0)throw new Error("Entity inputs are not supported in relationship-based queries");return null}if(entityInputs$$2===undefined)entityInputs$$2=this.getBaseEntity().getInputs().map(function(input$$4){var inputName$$17=input$$4.getName();return{input:inputName$$17,valueInput:inputName$$17}});
return this.createEntityInputsCompiler(entityInputs$$2)};
xdata.core.InsertQueryImpl.prototype._createInputsCompiler=function(options$$29){var inserts=options$$29&&options$$29.inserts;if(inserts===undefined)if(this.hasBaseEntity()){inserts=[];this.getBaseEntity().getAttributes().forEach(function(attr$$3){if(attr$$3.isKey())return;var attrName$$1=attr$$3.getName();return{property:attrName$$1,valueInput:attrName$$1}},this)}else inserts=[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$4){var keyAttrPath=entity$$4.getName()+
"."+entity$$4.getKeyAttribute().getName();return{property:keyAttrPath,valueInput:keyAttrPath}});return this.createInputsCompiler(inserts)};xdata.core.InsertQueryImpl.prototype._createKeyOutputs=function(){if(this.hasBaseEntity())return this.getBaseEntity().getKeyAttribute().getName();else return[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$5){return entity$$5.getName()+"."+entity$$5.getKeyAttribute().getName()})};
xdata.core.InsertQueryImpl.prototype.execute=function(tx$$20,parameters$$41){return this._doExecute(tx$$20,parameters$$41,this.getVoidExtractor())};exportProperty(xdata.core.InsertQueryImpl.prototype,"execute",xdata.core.InsertQueryImpl.prototype.execute);xdata.core.InsertQueryImpl.prototype.executeGetChanged=function(tx$$21,parameters$$42){return this._doExecute(tx$$21,parameters$$42,this.getFlagExtractor())};exportProperty(xdata.core.InsertQueryImpl.prototype,"executeGetChanged",xdata.core.InsertQueryImpl.prototype.executeGetChanged);
xdata.core.InsertQueryImpl.prototype.executeGetKey=function(tx$$22,parameters$$43){return this._doExecute(tx$$22,parameters$$43,this.getSingletonExtractor(this._createKeyOutputs()))};exportProperty(xdata.core.InsertQueryImpl.prototype,"executeGetKey",xdata.core.InsertQueryImpl.prototype.executeGetKey);
xdata.core.InsertQueryImpl.prototype._doExecute=function(tx$$23,parameters$$44,extractor$$2){var $jscomp$this$$12=this;return extractor$$2.extract(Promise.resolve().then(function(){return $jscomp$this$$12.prepareInputParameters(parameters$$44)}).then(function(inputParameters$$1){var descr$$10=$jscomp$this$$12._createCommandDescriptor(inputParameters$$1,extractor$$2);if(!descr$$10)return[];var command$$2=$jscomp$this$$12.db.compileInsertCommand(descr$$10);return tx$$23.executeCommand(command$$2,inputParameters$$1)}))};
xdata.core.InsertQueryImpl.prototype._createCommandDescriptor=function(parameters$$45,extractor$$3){var providerInputs$$2;var compiledInputs$$1=this._inputsCompiler.compile(parameters$$45);if(!compiledInputs$$1.isEmpty())providerInputs$$2=compiledInputs$$1.getProviderInputs();else return null;var providerStoreInputs$$3;if(this._entityInputsCompiler)providerStoreInputs$$3=this._entityInputsCompiler.compile(parameters$$45).getProviderStoreInputs();else providerStoreInputs$$3=[];return{storeOrRelationName:this.getBaseElementMappedName(),
storeInputs:providerStoreInputs$$3,inserts:providerInputs$$2,outputs:extractor$$3.getProviderOutputs()}};xdata.core.SelectQueryImpl=function(db$$15,erName$$21,options$$30){xdata.core.AbstractQuery.call(this,db$$15,erName$$21,undefined);this._entityInputsCompiler=this._createEntityInputsCompiler(options$$30);this._distinct=this._createDistinct(options$$30);this._outputs=this._createOutputs(options$$30);this._filterCompiler=this._createFilterCompiler(options$$30);this._order=this._createOrder(options$$30);this._limit=this._createLimit(options$$30)};extendConstructor(xdata.core.SelectQueryImpl,xdata.core.AbstractQuery);
exportSymbol("xdata.core.SelectQueryImpl",xdata.core.SelectQueryImpl);
xdata.core.SelectQueryImpl.prototype._createEntityInputsCompiler=function(options$$31){var entityInputs$$3=options$$31&&options$$31.entityInputs;if(!this.hasBaseEntity()){if(entityInputs$$3&&entityInputs$$3.length>0)throw new Error("Entity inputs are not supported in relationship-based queries");return null}if(entityInputs$$3===undefined)entityInputs$$3=this.getBaseEntity().getInputs().map(function(input$$5){var inputName$$18=input$$5.getName();return{input:inputName$$18,valueInput:inputName$$18}});
return this.createEntityInputsCompiler(entityInputs$$3)};xdata.core.SelectQueryImpl.prototype._createDistinct=function(options$$32){var distinct=options$$32&&options$$32.distinct;return distinct||false};
xdata.core.SelectQueryImpl.prototype._createOutputs=function(options$$33){var outputs$$9=options$$33&&options$$33.output;if(outputs$$9===undefined)if(this.hasBaseEntity())outputs$$9=this.getBaseEntity().getAttributes().map(function(attr$$4){return attr$$4.getName()},this);else outputs$$9=[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$6){return entity$$6.getName()+"."+entity$$6.getKeyAttribute().getName()});return outputs$$9};
xdata.core.SelectQueryImpl.prototype._createFilterCompiler=function(options$$34){var filter$$3=options$$34&&options$$34.filter;if(filter$$3===undefined)return null;return this.createFilterCompiler(filter$$3)};xdata.core.SelectQueryImpl.prototype._createOrder=function(options$$35){var order=options$$35&&options$$35.order;if(order===undefined)return null;return this.compileOrder(order)};
xdata.core.SelectQueryImpl.prototype._createLimit=function(options$$36){var limit=options$$36&&options$$36.limit;if(limit===undefined)return null;if(typeof limit==="number")return{count:limit,begin:undefined};return{count:limit.count,begin:limit.begin}};xdata.core.SelectQueryImpl.prototype.query=function(tx$$24,parameters$$46){return this._doExecute(tx$$24,parameters$$46,null,this.getCursorExtractor(this._outputs))};exportProperty(xdata.core.SelectQueryImpl.prototype,"query",xdata.core.SelectQueryImpl.prototype.query);
xdata.core.SelectQueryImpl.prototype.queryAll=function(tx$$25,parameters$$47){return this._doExecute(tx$$25,parameters$$47,null,this.getListExtractor(this._outputs))};exportProperty(xdata.core.SelectQueryImpl.prototype,"queryAll",xdata.core.SelectQueryImpl.prototype.queryAll);xdata.core.SelectQueryImpl.prototype.queryOne=function(tx$$26,parameters$$48){return this._doExecute(tx$$26,parameters$$48,1,this.getSingletonExtractor(this._outputs))};
exportProperty(xdata.core.SelectQueryImpl.prototype,"queryOne",xdata.core.SelectQueryImpl.prototype.queryOne);
xdata.core.SelectQueryImpl.prototype._doExecute=function(tx$$27,parameters$$49,maxCount,extractor$$4){var $jscomp$this$$13=this;return extractor$$4.extract(Promise.resolve().then(function(){return $jscomp$this$$13.prepareInputParameters(parameters$$49)}).then(function(inputParameters$$2){var descr$$11=$jscomp$this$$13._createCommandDescriptor(inputParameters$$2,maxCount,extractor$$4);if(!descr$$11)return[];var command$$3=$jscomp$this$$13.db.compileSelectCommand(descr$$11);return tx$$27.executeCommand(command$$3,
inputParameters$$2,true)}))};
xdata.core.SelectQueryImpl.prototype._createCommandDescriptor=function(parameters$$50,maxCount$$1,extractor$$5){var providerFiltetExpr$$1;if(this._filterCompiler){var compiledFilter$$2=this._filterCompiler.compile(parameters$$50);if(compiledFilter$$2.isApplicable())if(!compiledFilter$$2.isFixed())providerFiltetExpr$$1=compiledFilter$$2.getProviderExpression();else if(compiledFilter$$2.getFixedResult()===true)providerFiltetExpr$$1=undefined;else return null;else return null}else providerFiltetExpr$$1=undefined;
var providerOrderExpr;if(this._order)providerOrderExpr=this._order.getProviderExpression();else providerOrderExpr=[];var limit$$1;if(maxCount$$1!==null)limit$$1={begin:this._limit?this._limit.begin:undefined,count:maxCount$$1};else limit$$1=this._limit;var providerStoreInputs$$4;if(this._entityInputsCompiler)providerStoreInputs$$4=this._entityInputsCompiler.compile(parameters$$50).getProviderStoreInputs();else providerStoreInputs$$4=[];return{storeOrRelationName:this.getBaseElementMappedName(),storeInputs:providerStoreInputs$$4,
distinct:this._distinct,outputs:extractor$$5.getProviderOutputs(),filter:providerFiltetExpr$$1,order:providerOrderExpr,limit:limit$$1||undefined}};xdata.core.TransactionImpl=function(db$$16,providerTx){this._db=db$$16;this._providerTx=providerTx};exportSymbol("xdata.core.TransactionImpl",xdata.core.TransactionImpl);xdata.core.TransactionImpl.prototype.select=function(erName$$22,options$$37,parameters$$51){var query$$2=this._db.prepareSelect(erName$$22,options$$37);return query$$2.query(this,parameters$$51)};exportProperty(xdata.core.TransactionImpl.prototype,"select",xdata.core.TransactionImpl.prototype.select);
xdata.core.TransactionImpl.prototype.selectAll=function(erName$$23,options$$38,parameters$$52){var query$$3=this._db.prepareSelect(erName$$23,options$$38);return query$$3.queryAll(this,parameters$$52)};exportProperty(xdata.core.TransactionImpl.prototype,"selectAll",xdata.core.TransactionImpl.prototype.selectAll);xdata.core.TransactionImpl.prototype.selectOne=function(erName$$24,options$$39,parameters$$53){var query$$4=this._db.prepareSelect(erName$$24,options$$39);return query$$4.queryOne(this,parameters$$53)};
exportProperty(xdata.core.TransactionImpl.prototype,"selectOne",xdata.core.TransactionImpl.prototype.selectOne);xdata.core.TransactionImpl.prototype.insert=function(erName$$25,options$$40,parameters$$54){var query$$5=this._db.prepareInsert(erName$$25,options$$40);return query$$5.execute(this,parameters$$54)};exportProperty(xdata.core.TransactionImpl.prototype,"insert",xdata.core.TransactionImpl.prototype.insert);
xdata.core.TransactionImpl.prototype.insertGetChanged=function(erName$$26,options$$41,parameters$$55){var query$$6=this._db.prepareInsert(erName$$26,options$$41);return query$$6.executeGetChanged(this,parameters$$55)};exportProperty(xdata.core.TransactionImpl.prototype,"insertGetChanged",xdata.core.TransactionImpl.prototype.insertGetChanged);
xdata.core.TransactionImpl.prototype.insertGetKey=function(erName$$27,options$$42,parameters$$56){var query$$7=this._db.prepareInsert(erName$$27,options$$42);return query$$7.executeGetKey(this,parameters$$56)};exportProperty(xdata.core.TransactionImpl.prototype,"insertGetKey",xdata.core.TransactionImpl.prototype.insertGetKey);
xdata.core.TransactionImpl.prototype.update=function(erName$$28,options$$43,parameters$$57){var query$$8=this._db.prepareUpdate(erName$$28,options$$43);return query$$8.execute(this,parameters$$57)};exportProperty(xdata.core.TransactionImpl.prototype,"update",xdata.core.TransactionImpl.prototype.update);
xdata.core.TransactionImpl.prototype.updateGetChanged=function(erName$$29,options$$44,parameters$$58){var query$$9=this._db.prepareUpdate(erName$$29,options$$44);return query$$9.executeGetChanged(this,parameters$$58)};exportProperty(xdata.core.TransactionImpl.prototype,"updateGetChanged",xdata.core.TransactionImpl.prototype.updateGetChanged);
xdata.core.TransactionImpl.prototype.updateGetCount=function(erName$$30,options$$45,parameters$$59){var query$$10=this._db.prepareUpdate(erName$$30,options$$45);return query$$10.executeGetCount(this,parameters$$59)};exportProperty(xdata.core.TransactionImpl.prototype,"updateGetCount",xdata.core.TransactionImpl.prototype.updateGetCount);
xdata.core.TransactionImpl.prototype.updateGetKeys=function(erName$$31,options$$46,parameters$$60){var query$$11=this._db.prepareUpdate(erName$$31,options$$46);return query$$11.executeGetKeys(this,parameters$$60)};exportProperty(xdata.core.TransactionImpl.prototype,"updateGetKeys",xdata.core.TransactionImpl.prototype.updateGetKeys);
xdata.core.TransactionImpl.prototype["delete"]=function(erName$$32,options$$47,parameters$$61){var query$$12=this._db.prepareDelete(erName$$32,options$$47);return query$$12.execute(this,parameters$$61)};xdata.core.TransactionImpl.prototype.deleteGetChanged=function(erName$$33,options$$48,parameters$$62){var query$$13=this._db.prepareDelete(erName$$33,options$$48);return query$$13.executeGetChanged(this,parameters$$62)};exportProperty(xdata.core.TransactionImpl.prototype,"deleteGetChanged",xdata.core.TransactionImpl.prototype.deleteGetChanged);
xdata.core.TransactionImpl.prototype.deleteGetCount=function(erName$$34,options$$49,parameters$$63){var query$$14=this._db.prepareDelete(erName$$34,options$$49);return query$$14.executeGetCount(this,parameters$$63)};exportProperty(xdata.core.TransactionImpl.prototype,"deleteGetCount",xdata.core.TransactionImpl.prototype.deleteGetCount);
xdata.core.TransactionImpl.prototype.deleteGetKeys=function(erName$$35,options$$50,parameters$$64){var query$$15=this._db.prepareDelete(erName$$35,options$$50);return query$$15.executeGetKeys(this,parameters$$64)};exportProperty(xdata.core.TransactionImpl.prototype,"deleteGetKeys",xdata.core.TransactionImpl.prototype.deleteGetKeys);
xdata.core.TransactionImpl.prototype.executeCommand=function(command$$4,parameters$$65,withMetadata){var metadataEmbedder$$1=withMetadata?xdata.core.embedProviderMetadata:null;return this._providerTx.executeCommand(command$$4,parameters$$65,metadataEmbedder$$1)};xdata.core.TransactionImpl.prototype.resolve=function(){var providerTx$$1=this._providerTx;return Promise.resolve().then(function(){return providerTx$$1.resolve()})};exportProperty(xdata.core.TransactionImpl.prototype,"resolve",xdata.core.TransactionImpl.prototype.resolve);xdata.core.SessionImpl=function(db$$17,providerSession){this._db=db$$17;this._providerSession=providerSession};exportSymbol("xdata.core.SessionImpl",xdata.core.SessionImpl);
xdata.core.SessionImpl.prototype.createTransaction=function(options$$51){var $jscomp$this$$14=this;return Promise.resolve().then(function(){var descr$$12=$jscomp$this$$14._createTransactionDescriptor(options$$51);return $jscomp$this$$14._providerSession.createTransaction(descr$$12)}).then(function(providerTx$$2){return new xdata.core.TransactionImpl($jscomp$this$$14._db,providerTx$$2)})};exportProperty(xdata.core.SessionImpl.prototype,"createTransaction",xdata.core.SessionImpl.prototype.createTransaction);
xdata.core.SessionImpl.prototype._createTransactionDescriptor=function(options$$52){var readOnly=!!(options$$52&&options$$52.readOnly);var atomic=options$$52&&options$$52.atomic;if(typeof atomic==="undefined")atomic=false;else if(typeof atomic==="number")atomic={interval:atomic,backoff:undefined};return{readOnly:readOnly,atomic:atomic}};xdata.core.UpdateQueryImpl=function(db$$18,erName$$36,options$$53){xdata.core.AbstractQuery.call(this,db$$18,erName$$36,"afterUpdate");this._entityInputsCompiler=this._createEntityInputsCompiler(options$$53);this._inputsCompiler=this._createInputsCompiler(options$$53);this._filterCompiler=this._createFilterCompiler(options$$53)};extendConstructor(xdata.core.UpdateQueryImpl,xdata.core.AbstractQuery);exportSymbol("xdata.core.UpdateQueryImpl",xdata.core.UpdateQueryImpl);
xdata.core.UpdateQueryImpl.prototype._createEntityInputsCompiler=function(options$$54){var entityInputs$$4=options$$54&&options$$54.entityInputs;if(!this.hasBaseEntity()){if(entityInputs$$4&&entityInputs$$4.length>0)throw new Error("Entity inputs are not supported in relationship-based queries");return null}if(entityInputs$$4===undefined)entityInputs$$4=this.getBaseEntity().getInputs().map(function(input$$6){var inputName$$19=input$$6.getName();return{input:inputName$$19,valueInput:inputName$$19}});
return this.createEntityInputsCompiler(entityInputs$$4)};
xdata.core.UpdateQueryImpl.prototype._createInputsCompiler=function(options$$55){var updates=options$$55&&options$$55.updates;if(updates===undefined)if(this.hasBaseEntity()){updates=[];this.getBaseEntity().getAttributes().forEach(function(attr$$5){if(attr$$5.isKey())return;var attrName$$2=attr$$5.getName();return{property:attrName$$2,valueInput:attrName$$2}},this)}else updates=[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$7){var keyAttrPath$$1=entity$$7.getName()+
"."+entity$$7.getKeyAttribute().getName();return{property:keyAttrPath$$1,valueInput:keyAttrPath$$1}});return this.createInputsCompiler(updates)};xdata.core.UpdateQueryImpl.prototype._createFilterCompiler=function(options$$56){var filter$$4=options$$56&&options$$56.filter;if(filter$$4===undefined)return null;return this.createFilterCompiler(filter$$4)};
xdata.core.UpdateQueryImpl.prototype._createKeyOutputs=function(){if(this.hasBaseEntity())return this.getBaseEntity().getKeyAttribute().getName();else return[this.getBaseRelationship().getEntity1(),this.getBaseRelationship().getEntity2()].map(function(entity$$8){return entity$$8.getName()+"."+entity$$8.getKeyAttribute().getName()})};xdata.core.UpdateQueryImpl.prototype.execute=function(tx$$28,parameters$$66){return this._doExecute(tx$$28,parameters$$66,this.getVoidExtractor())};
exportProperty(xdata.core.UpdateQueryImpl.prototype,"execute",xdata.core.UpdateQueryImpl.prototype.execute);xdata.core.UpdateQueryImpl.prototype.executeGetChanged=function(tx$$29,parameters$$67){return this._doExecute(tx$$29,parameters$$67,this.getFlagExtractor())};exportProperty(xdata.core.UpdateQueryImpl.prototype,"executeGetChanged",xdata.core.UpdateQueryImpl.prototype.executeGetChanged);
xdata.core.UpdateQueryImpl.prototype.executeGetCount=function(tx$$30,parameters$$68){return this._doExecute(tx$$30,parameters$$68,this.getCountExtractor())};exportProperty(xdata.core.UpdateQueryImpl.prototype,"executeGetCount",xdata.core.UpdateQueryImpl.prototype.executeGetCount);xdata.core.UpdateQueryImpl.prototype.executeGetKeys=function(tx$$31,parameters$$69){return this._doExecute(tx$$31,parameters$$69,this.getListExtractor(this._createKeyOutputs()))};
exportProperty(xdata.core.UpdateQueryImpl.prototype,"executeGetKeys",xdata.core.UpdateQueryImpl.prototype.executeGetKeys);
xdata.core.UpdateQueryImpl.prototype._doExecute=function(tx$$32,parameters$$70,extractor$$6){var $jscomp$this$$15=this;return extractor$$6.extract(Promise.resolve().then(function(){return $jscomp$this$$15.prepareInputParameters(parameters$$70)}).then(function(inputParameters$$3){var descr$$13=$jscomp$this$$15._createCommandDescriptor(inputParameters$$3,extractor$$6);if(!descr$$13)return[];var command$$5=$jscomp$this$$15.db.compileUpdateCommand(descr$$13);return tx$$32.executeCommand(command$$5,inputParameters$$3)}))};
xdata.core.UpdateQueryImpl.prototype._createCommandDescriptor=function(parameters$$71,extractor$$7){var providerInputs$$3;var compiledInputs$$2=this._inputsCompiler.compile(parameters$$71);if(!compiledInputs$$2.isEmpty())providerInputs$$3=compiledInputs$$2.getProviderInputs();else return null;var providerFiltetExpr$$2;if(this._filterCompiler){var compiledFilter$$3=this._filterCompiler.compile(parameters$$71);if(compiledFilter$$3.isApplicable())if(!compiledFilter$$3.isFixed())providerFiltetExpr$$2=
compiledFilter$$3.getProviderExpression();else if(compiledFilter$$3.getFixedResult()===true)providerFiltetExpr$$2=undefined;else return null;else return null}else providerFiltetExpr$$2=undefined;var providerStoreInputs$$5;if(this._entityInputsCompiler)providerStoreInputs$$5=this._entityInputsCompiler.compile(parameters$$71).getProviderStoreInputs();else providerStoreInputs$$5=[];return{storeOrRelationName:this.getBaseElementMappedName(),storeInputs:providerStoreInputs$$5,updates:providerInputs$$3,
filter:providerFiltetExpr$$2,outputs:extractor$$7.getProviderOutputs()}};xdata.core.ValueAccessor=function(typeHandler,fieldName$$13){this._typeHandler=typeHandler;this._fieldName=fieldName$$13!==undefined?fieldName$$13:null};xdata.core.ValueAccessor.prototype.getMapping=function(){if(this._fieldName!==null)return[{field:this._fieldName}];var mapping$$3=this._typeHandler.getMapping();if(typeof mapping$$3!=="object")return[{field:""}];else return Object.keys(mapping$$3).map(function(field$$9){return{field:field$$9}})};
xdata.core.ValueAccessor.prototype.getOperatorMapping=function(operator$$4){if(this._fieldName!==null)return[{field:this._fieldName,operator:operator$$4}];var mapping$$4=this._typeHandler.getOperatorMapping(operator$$4);if(typeof mapping$$4!=="object")return[{field:"",operator:mapping$$4}];else return Object.keys(mapping$$4).map(function(field$$10){return{field:field$$10,operator:mapping$$4[field$$10]}})};
xdata.core.ValueAccessor.prototype.getOrderMapping=function(descending$$2){if(this._fieldName!==null)return[{field:this._fieldName,descending:descending$$2}];var mapping$$5=this._typeHandler.getOrderMapping(descending$$2);if(typeof mapping$$5!=="object")return[{field:"",descending:mapping$$5}];else return Object.keys(mapping$$5).map(function(field$$11){return{field:field$$11,descending:mapping$$5[field$$11]}})};
xdata.core.ValueAccessor.prototype.write=function(mappedValue$$6,value$$75){if(this._fieldName!==null)mappedValue$$6=new xdata.core.ValueAccessor._FieldScopedMappeValue(mappedValue$$6,this._fieldName);if(Array.isArray(value$$75))if(value$$75.length===1)return this._typeHandler.write(mappedValue$$6,value$$75[0]);else if(value$$75.length<1)return;else throw new Error("Unable to obtain a single value from input array of length "+value$$75.length);return this._typeHandler.write(mappedValue$$6,value$$75)};
xdata.core.ValueAccessor.prototype.writeMultiple=function(mappedValue$$7,value$$76){if(!Array.isArray(value$$76))return this.write(mappedValue$$7,value$$76);var writePromises=[];var mappedElementValue=mappedValue$$7.createCopy();var i$$22=0;for(;i$$22<value$$76.length;i$$22++){mappedElementValue.setBaseIndex(i$$22);var writeResult$$2=this.write(mappedElementValue,value$$76[i$$22]);if(xdata.util.isPromise(writeResult$$2)){writePromises.push(writeResult$$2);mappedElementValue=mappedElementValue.createCopy()}}if(writePromises.length>
0)return Promise.all(writePromises)};xdata.core.ValueAccessor.prototype.read=function(mappedValue$$8){if(this._fieldName!==null)mappedValue$$8=new xdata.core.ValueAccessor._FieldScopedMappeValue(mappedValue$$8,this._fieldName);return this._typeHandler.read(mappedValue$$8)};
xdata.core.ValueAccessor.prototype.isPresent=function(mappedValue$$9,acceptNull$$4){var mapping$$6=this.getMapping();var i$$23=0;for(;i$$23<mapping$$6.length;i$$23++)if(!xdata.core.isEmptyValue(mappedValue$$9.get(mapping$$6[i$$23].field),acceptNull$$4))return true;return false};xdata.core.ValueAccessor._FieldScopedMappeValue=function(delegate,fieldName$$14){this._delegate=delegate;this._fieldName=fieldName$$14};
xdata.core.ValueAccessor._FieldScopedMappeValue.prototype.setDefault=function(value$$77){this._delegate.set(this._fieldName,value$$77)};xdata.core.ValueAccessor._FieldScopedMappeValue.prototype.getDefault=function(){return this._delegate.get(this._fieldName)};xdata.core.ValueAccessor._FieldScopedMappeValue.prototype.set=function(fieldName$$15,fieldValue$$2){if(fieldName$$15!=="")throw new Error("Invalid field '"+fieldName$$15+"'");this._delegate.set(this._fieldName,fieldValue$$2)};
xdata.core.ValueAccessor._FieldScopedMappeValue.prototype.get=function(fieldName$$16){if(fieldName$$16!=="")throw new Error("Invalid field '"+fieldName$$16+"'");return this._delegate.get(this._fieldName)};xdata.SimpleType={ARRAYBUFFER:"arraybuffer",BOOLEAN:"boolean",DATE:"date",DECIMAL:"decimal",INTEGER:"integer",REAL:"real",STRING:"string"};exportSymbol("xdata.SimpleType",xdata.SimpleType);xdata.core.SimpleTypeHandlers={};xdata.core.SimpleTypeHandlers.define=function(simpleType,textualOperators,convertFunction){xdata.core.SimpleTypeHandlers[simpleType]=new xdata.core.SimpleTypeHandler(simpleType,textualOperators,convertFunction)};xdata.core.SimpleTypeHandler=function(simpleType$$1,textualOperators$$1,convertFunction$$1){this._simpleType=simpleType$$1;this._textualOperators=textualOperators$$1;this._convertFunction=convertFunction$$1};
xdata.core.SimpleTypeHandler.prototype.getMapping=function(){return this._simpleType};xdata.core.SimpleTypeHandler.prototype.getOperatorMapping=function(operator$$5){var ValueOperator=xdata.ValueOperator;if(!this._textualOperators)switch(operator$$5){case ValueOperator.EMPTY:return ValueOperator.NULL;case ValueOperator.NOT_EMPTY:return ValueOperator.NOT_NULL}return operator$$5};xdata.core.SimpleTypeHandler.prototype.getOrderMapping=function(descending$$3){return descending$$3};
xdata.core.SimpleTypeHandler.prototype.read=function(mappedValue$$10){return mappedValue$$10.getDefault()};xdata.core.SimpleTypeHandler.prototype.write=function(mappedValue$$11,value$$78){if(value$$78===null||value$$78===undefined)mappedValue$$11.setDefault(value$$78);else mappedValue$$11.setDefault(this._convertFunction(value$$78))};
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.ARRAYBUFFER,false,function(value$$79){function isArrayBuffer(value$$80){return value$$80 instanceof ArrayBuffer||typeof value$$80["byteLength"]==="number"}if(isArrayBuffer(value$$79))return value$$79;if("buffer"in value$$79&&isArrayBuffer(value$$79["buffer"]))return value$$79["buffer"];throw new Error("Value not convertible to ArrayBuffer: "+value$$79);});
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.BOOLEAN,false,function(value$$81){if(value$$81===true||value$$81==="true")return true;if(value$$81 instanceof Boolean)return!!value$$81.valueOf();if(typeof value$$81==="number")return value$$81!==0;return false});
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.DATE,false,function(value$$82){if(Object.prototype.toString.call(value$$82)==="[object Date]")return value$$82;if(typeof value$$82==="number"||typeof value$$82==="string")return new Date(value$$82);throw new Error("Value not convertible to Date: "+value$$82);});
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.DECIMAL,false,function(value$$83){if(value$$83 instanceof Number)value$$83=value$$83.valueOf();if(typeof value$$83==="number"){if(!isFinite(value$$83))throw new Error("Value not convertible to decimal string: "+value$$83);return String(value$$83)}var s$$3=String(value$$83);if(!/^[+\-]?(?:\d+(?:\.\d+)?|\.\d+)$/.test(s$$3))throw new Error("Value not convertible to decimal string: "+value$$83);return s$$3});
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.INTEGER,false,function(value$$84){var n$$4=Number(value$$84);if(isNaN(n$$4))throw new Error("Value not convertible to number: "+value$$84);if(n$$4%1!==0)throw new Error("Value not convertible to integer: "+value$$84);return n$$4});xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.REAL,false,function(value$$85){var n$$5=Number(value$$85);if(isNaN(n$$5))throw new Error("Value not convertible to number: "+value$$85);return n$$5});
xdata.core.SimpleTypeHandlers.define(xdata.SimpleType.STRING,true,function(value$$86){return String(value$$86)});xdata.core.TypeHandlers=function(noGlobals){this._handlers=noGlobals?{}:xdata.util.assignObject({},xdata.core.TypeHandlers._GLOBAL._handlers);this._overridden={}};xdata.core.TypeHandlers.prototype.register=function(type$$66,handler$$2){if(this._overridden.hasOwnProperty(type$$66))throw new Error("Handler for type '"+type$$66+"' is already registered");this._handlers[type$$66]=handler$$2;this._overridden[type$$66]=true};
xdata.core.TypeHandlers.prototype.get=function(type$$67){var handler$$3=this._handlers[type$$67];if(!handler$$3)throw new Error("Unknown type '"+type$$67+"'");return handler$$3};
xdata.core.TypeHandlers._GLOBAL=function(){var globalTypeHandlers=new xdata.core.TypeHandlers(true);xdata.util.getEnumValues(xdata.SimpleType).forEach(function(simpleType$$2){var handler$$4=xdata.core.SimpleTypeHandlers[simpleType$$2];if(DEBUG&&!handler$$4)throw new Error("No handler available for simple type "+simpleType$$2);globalTypeHandlers.register(simpleType$$2,handler$$4)});return globalTypeHandlers}();
xdata.core.TypeHandlers.register=function(type$$68,handler$$5){xdata.core.TypeHandlers._GLOBAL.register(type$$68,handler$$5)};xdata.schema={};xdata.schema.readValue=function(config,property$$4,label$$2){var value$$87=config[property$$4];if(value$$87===null||value$$87===undefined||value$$87==="")throw new Error("Missing required "+(label$$2||"'"+property$$4+"' property"));return value$$87};
xdata.schema.readEnumValue=function(config$$1,property$$5,enumType$$5,label$$3){var rawValue=xdata.schema.readValue(config$$1,property$$5,label$$3);try{return xdata.util.castEnumValue(enumType$$5,rawValue)}catch(e){if(e instanceof TypeError)throw new Error("Invalid "+(label$$3||"'"+property$$5+"' property")+" value. Validd values are: "+xdata.util.getEnumValues(enumType$$5).join(", "));throw e;}};
xdata.schema.readNamedElements=function(config$$2,property$$6,ctor$$6,schema$$3,label$$4){var rawValue$$1=xdata.schema.readValue(config$$2,property$$6,label$$4);var map$$1=xdata.util.mapObject(rawValue$$1,function(elementConfig,elementName$$1){try{return xdata.util.construct(ctor$$6,elementName$$1,elementConfig,schema$$3)}catch(e$$1){throw new Error("Error constructing schema of "+(label$$4||"'"+property$$6+"' object value at")+" '"+elementName$$1+"': "+e$$1.message);}});return{map:map$$1,list:xdata.util.extractValues(map$$1)}};
xdata.schema.getExisting=function(object$$8,key$$22,label$$5){var value$$88=object$$8[key$$22];if(value$$88==null||value$$88==undefined)throw new Error("Unknown "+label$$5+" '"+key$$22+"'");return value$$88};xdata.schema.Element=function(name$$39,config$$3,schema$$4){this._name=xdata.schema.Element._validateName(name$$39);this._identity=config$$3["identity"]||null;this._providerConfigs=xdata.schema.Element._constructProviderConfigs(config$$3);this._schema=schema$$4};exportSymbol("xdata.schema.Element",xdata.schema.Element);xdata.schema.Element._validateName=function(name$$40){if(!/^[^\s\.()]*$/.test(name$$40))throw new Error("Name contains illegal characters");return name$$40};
xdata.schema.Element._constructProviderConfigs=function(config$$4){var providerConfigs=config$$4["provider"];if(!xdata.util.isObject(providerConfigs))return{};var result$$10={};xdata.util.forEachOfObject(providerConfigs,function(value$$89,key$$23){var match=/^([^\.]+)\.(.+)$/.exec(key$$23);if(!match)throw new Error("Invalid provider configuration key '"+key$$23+"'");var providerKey=match[1];var valueKey=match[2];var providerConfig=result$$10[providerKey];if(!providerConfig)result$$10[providerKey]=
providerConfig={};providerConfig[valueKey]=value$$89});return result$$10};xdata.schema.Element.prototype.getName=function(){return this._name};exportProperty(xdata.schema.Element.prototype,"getName",xdata.schema.Element.prototype.getName);xdata.schema.Element.prototype.getIdentity=function(){return this._identity};exportProperty(xdata.schema.Element.prototype,"getIdentity",xdata.schema.Element.prototype.getIdentity);
xdata.schema.Element.prototype.getProviderConfig=function(providerName$$1){return this._providerConfigs[providerName$$1]||{}};exportProperty(xdata.schema.Element.prototype,"getProviderConfig",xdata.schema.Element.prototype.getProviderConfig);xdata.schema.Element.prototype.getSchema=function(){return this._schema};exportProperty(xdata.schema.Element.prototype,"getSchema",xdata.schema.Element.prototype.getSchema);xdata.schema.Element.prototype.toString=function(){return this._name};
exportProperty(xdata.schema.Element.prototype,"toString",xdata.schema.Element.prototype.toString);xdata.schema.Schema=function(config$$5){xdata.schema.Element.call(this,"",config$$5,this);config$$5=xdata.schema.Schema.normalizeConfig(config$$5);var typeHandlers=new xdata.core.TypeHandlers;if(config$$5["typeHandlers"])xdata.util.forEachOfObject(config$$5["typeHandlers"],function(handler$$6,type$$69){typeHandlers.register(type$$69,handler$$6)});this._typeHandlers=typeHandlers;this._rels=xdata.schema.readNamedElements(config$$5,"relationships",xdata.schema.Relationship,this,"relationship");this._entities=
xdata.schema.readNamedElements(config$$5,"entities",xdata.schema.Entity,this,"entity");this._entities.list.forEach(function(entity$$9){if(this._rels.map.hasOwnProperty(entity$$9.getName()))throw new Error("Name '"+entity$$9.getName()+"' conflict between entities and relationships");},this)};extendConstructor(xdata.schema.Schema,xdata.schema.Element);exportSymbol("xdata.schema.Schema",xdata.schema.Schema);
xdata.schema.Schema.normalizeConfig=function(config$$6){if(!config$$6)throw new Error("Missing configuration");if(!config$$6.hasOwnProperty("entities"))config$$6["entities"]={};if(!config$$6.hasOwnProperty("relationships"))config$$6["relationships"]={};return config$$6};xdata.schema.Schema.EMPTY=new xdata.schema.Schema({});xdata.schema.Schema.normalize=function(schemaOrConfig){if(schemaOrConfig instanceof xdata.schema.Schema)return schemaOrConfig;return new xdata.schema.Schema(schemaOrConfig)};
xdata.schema.Schema.prototype.getTypeHandler=function(type$$70){return this._typeHandlers.get(type$$70)};exportProperty(xdata.schema.Schema.prototype,"getTypeHandler",xdata.schema.Schema.prototype.getTypeHandler);xdata.schema.Schema.prototype.getEntities=function(){return this._entities.list};exportProperty(xdata.schema.Schema.prototype,"getEntities",xdata.schema.Schema.prototype.getEntities);xdata.schema.Schema.prototype.hasEntity=function(name$$41){return!!this._entities.map[name$$41]};
exportProperty(xdata.schema.Schema.prototype,"hasEntity",xdata.schema.Schema.prototype.hasEntity);xdata.schema.Schema.prototype.getEntity=function(name$$42){return xdata.schema.getExisting(this._entities.map,name$$42,"entity")};exportProperty(xdata.schema.Schema.prototype,"getEntity",xdata.schema.Schema.prototype.getEntity);xdata.schema.Schema.prototype.getRelationships=function(){return this._rels.list};exportProperty(xdata.schema.Schema.prototype,"getRelationships",xdata.schema.Schema.prototype.getRelationships);
xdata.schema.Schema.prototype.hasRelationship=function(name$$43){return!!this._rels.map[name$$43]};exportProperty(xdata.schema.Schema.prototype,"hasRelationship",xdata.schema.Schema.prototype.hasRelationship);xdata.schema.Schema.prototype.getRelationship=function(name$$44){return xdata.schema.getExisting(this._rels.map,name$$44,"relationship")};exportProperty(xdata.schema.Schema.prototype,"getRelationship",xdata.schema.Schema.prototype.getRelationship);
xdata.schema.Schema.prototype.getEntityOrRelationship=function(name$$45){if(this._entities.map.hasOwnProperty(name$$45))return this._entities.map[name$$45];return xdata.schema.getExisting(this._rels.map,name$$45,"entity or relationship")};exportProperty(xdata.schema.Schema.prototype,"getEntityOrRelationship",xdata.schema.Schema.prototype.getEntityOrRelationship);xdata.core.DatabaseImpl=function(providerName$$2,providerConfig$$1,version$$7,schema$$5){this._providerName=providerName$$2;this._version=version$$7;this._schemaMapper=new xdata.core.SchemaMapper(schema$$5,providerName$$2);var provider=xdata.core.DatabaseImpl._getProvider(providerName$$2,providerConfig$$1);var providerDb=provider.createDatabase(version$$7,this._schemaMapper.getProviderSchema());this._providerDb=providerDb;this._selectCommandCache=new xdata.util.ObjectCache(providerDb.compileSelectCommand.bind(providerDb));
this._insertCommandCache=new xdata.util.ObjectCache(providerDb.compileInsertCommand.bind(providerDb));this._updateCommandCache=new xdata.util.ObjectCache(providerDb.compileUpdateCommand.bind(providerDb));this._deleteCommandCache=new xdata.util.ObjectCache(providerDb.compileDeleteCommand.bind(providerDb));this._listeners=[]};exportSymbol("xdata.core.DatabaseImpl",xdata.core.DatabaseImpl);xdata.core.DatabaseImpl.prototype.getVersion=function(){return this._version};
exportProperty(xdata.core.DatabaseImpl.prototype,"getVersion",xdata.core.DatabaseImpl.prototype.getVersion);xdata.core.DatabaseImpl.prototype.getSchema=function(){return this._schemaMapper.getSchema()};exportProperty(xdata.core.DatabaseImpl.prototype,"getSchema",xdata.core.DatabaseImpl.prototype.getSchema);
xdata.core.DatabaseImpl.prototype.createSession=function(concreteDatabaseName$$4,options$$57){var $jscomp$this$$16=this;var autoCreate=options$$57&&options$$57.autoCreate;if(autoCreate===undefined)autoCreate=true;var providerDb$$1=this._providerDb;var descr$$14=this._createSessionDescriptor(options$$57);var providerSessionPromise=Promise.resolve().then(function(){return providerDb$$1.createSession(concreteDatabaseName$$4,descr$$14)}).catch(function(e$$2){if(autoCreate&&e$$2 instanceof xdata.VersionError&&
e$$2.actualVersion<0){var providerSchemaFactory=$jscomp$this$$16._createSchemaFactory();return Promise.resolve(providerDb$$1.upgradeVersion(concreteDatabaseName$$4,providerSchemaFactory)).then(function(){return providerDb$$1.createSession(concreteDatabaseName$$4,descr$$14)})}throw e$$2;});return providerSessionPromise.then(function(providerSession$$1){return new xdata.core.SessionImpl($jscomp$this$$16,providerSession$$1)})};exportProperty(xdata.core.DatabaseImpl.prototype,"createSession",xdata.core.DatabaseImpl.prototype.createSession);
xdata.core.DatabaseImpl.prototype._createSessionDescriptor=function(options$$58){var username=options$$58&&options$$58.username;var password=options$$58&&options$$58.password;if(username===undefined)username=null;if(password===undefined)password=null;return{username:username,password:password}};
xdata.core.DatabaseImpl.prototype.upgradeVersion=function(concreteDatabaseName$$5,schemaFactory$$1){var providerDb$$2=this._providerDb;var providerSchemaFactory$$1=this._createSchemaFactory(schemaFactory$$1);return Promise.resolve().then(function(){return providerDb$$2.upgradeVersion(concreteDatabaseName$$5,providerSchemaFactory$$1)})};exportProperty(xdata.core.DatabaseImpl.prototype,"upgradeVersion",xdata.core.DatabaseImpl.prototype.upgradeVersion);
xdata.core.DatabaseImpl.prototype._createSchemaFactory=function(highLevelSchemaFactory){var providerName$$3=this._providerName;return function schemaFactory$$2(version$$8){var schema$$6;if(version$$8<0)schema$$6=xdata.schema.Schema.EMPTY;else if(highLevelSchemaFactory)schema$$6=xdata.schema.Schema.normalize(highLevelSchemaFactory(version$$8));else throw new Error("No schema available for version "+version$$8);var schemaMapper=new xdata.core.SchemaMapper(schema$$6,providerName$$3);return schemaMapper.getProviderSchema()}};
xdata.core.DatabaseImpl.prototype.getAttributeValueAccessor=function(attribute,fieldName$$17){var typeHandler$$1;if(fieldName$$17!==undefined)typeHandler$$1=this.getSchema().getTypeHandler(attribute.getField(fieldName$$17).getType());else typeHandler$$1=this.getSchema().getTypeHandler(attribute.getType());return new xdata.core.ValueAccessor(typeHandler$$1,fieldName$$17)};
xdata.core.DatabaseImpl.prototype.getInputValueAccessor=function(input$$7,fieldName$$18){var typeHandler$$2;if(fieldName$$18!==undefined)typeHandler$$2=this.getSchema().getTypeHandler(input$$7.getField(fieldName$$18).getType());else typeHandler$$2=this.getSchema().getTypeHandler(input$$7.getType());return new xdata.core.ValueAccessor(typeHandler$$2,fieldName$$18)};
xdata.core.DatabaseImpl.prototype.prepareSelect=function(erName$$37,options$$59){return new xdata.core.SelectQueryImpl(this,erName$$37,options$$59)};exportProperty(xdata.core.DatabaseImpl.prototype,"prepareSelect",xdata.core.DatabaseImpl.prototype.prepareSelect);xdata.core.DatabaseImpl.prototype.compileSelectCommand=function(selectDescr){return this._selectCommandCache.get(selectDescr)};
xdata.core.DatabaseImpl.prototype.prepareInsert=function(erName$$38,options$$60){return new xdata.core.InsertQueryImpl(this,erName$$38,options$$60)};exportProperty(xdata.core.DatabaseImpl.prototype,"prepareInsert",xdata.core.DatabaseImpl.prototype.prepareInsert);xdata.core.DatabaseImpl.prototype.compileInsertCommand=function(insertDescr){return this._insertCommandCache.get(insertDescr)};
xdata.core.DatabaseImpl.prototype.prepareUpdate=function(erName$$39,options$$61){return new xdata.core.UpdateQueryImpl(this,erName$$39,options$$61)};exportProperty(xdata.core.DatabaseImpl.prototype,"prepareUpdate",xdata.core.DatabaseImpl.prototype.prepareUpdate);xdata.core.DatabaseImpl.prototype.compileUpdateCommand=function(updateDescr){return this._updateCommandCache.get(updateDescr)};
xdata.core.DatabaseImpl.prototype.prepareDelete=function(erName$$40,options$$62){return new xdata.core.DeleteQueryImpl(this,erName$$40,options$$62)};exportProperty(xdata.core.DatabaseImpl.prototype,"prepareDelete",xdata.core.DatabaseImpl.prototype.prepareDelete);xdata.core.DatabaseImpl.prototype.compileDeleteCommand=function(deleteDescr){return this._deleteCommandCache.get(deleteDescr)};
xdata.core.DatabaseImpl.prototype.attachSession=function(lowLevelConn$$2){var providerSession$$2=this._providerDb.attachSession(lowLevelConn$$2);return new xdata.core.SessionImpl(this,providerSession$$2)};exportProperty(xdata.core.DatabaseImpl.prototype,"attachSession",xdata.core.DatabaseImpl.prototype.attachSession);
xdata.core.DatabaseImpl.prototype.attachTransaction=function(lowLevelTx$$2){var providerTx$$3=this._providerDb.attachTransaction(lowLevelTx$$2);return new xdata.core.TransactionImpl(this,providerTx$$3)};exportProperty(xdata.core.DatabaseImpl.prototype,"attachTransaction",xdata.core.DatabaseImpl.prototype.attachTransaction);
xdata.core.DatabaseImpl.prototype.addListener=function(listener$$42){var providerListener=new xdata.core.EventListenerAdapter(this,listener$$42);this._providerDb.addListener(providerListener);this._listeners.push({listener:listener$$42,providerListener:providerListener})};exportProperty(xdata.core.DatabaseImpl.prototype,"addListener",xdata.core.DatabaseImpl.prototype.addListener);
xdata.core.DatabaseImpl.prototype.removeListener=function(listener$$43){var i$$24=0;for(;i$$24<this._listeners.length;i$$24++)if(this._listeners[i$$24].listener===listener$$43){this._providerDb.removeListener(this._listeners[i$$24].providerListener);this._listeners.splice(i$$24,1);return}};exportProperty(xdata.core.DatabaseImpl.prototype,"removeListener",xdata.core.DatabaseImpl.prototype.removeListener);xdata.core.DatabaseImpl._PROVIDERS_REGISTRY={};
xdata.core.DatabaseImpl.registerProviderConstructor=function(name$$46,ctor$$7){var REGITRY=xdata.core.DatabaseImpl._PROVIDERS_REGISTRY;if(REGITRY.hasOwnProperty(name$$46))throw new Error("Provider '"+name$$46+"' already registered");REGITRY[name$$46]={ctor:ctor$$7,instance:null}};
xdata.core.DatabaseImpl._getProvider=function(name$$47,config$$7){var REGITRY$$1=xdata.core.DatabaseImpl._PROVIDERS_REGISTRY;var providerInfo=REGITRY$$1[name$$47];if(!providerInfo)throw new Error("Unknown provider '"+name$$47+"'");var instance$$1=providerInfo.instance;if(!instance$$1){instance$$1=xdata.util.construct(providerInfo.ctor,config$$7);providerInfo.instance=instance$$1}return instance$$1};xdata.EventListener=function(){};exportSymbol("xdata.EventListener",xdata.EventListener);xdata.EventListener.prototype.begunTransaction=function(event$$9){};exportProperty(xdata.EventListener.prototype,"begunTransaction",xdata.EventListener.prototype.begunTransaction);xdata.EventListener.prototype.resolvedTransaction=function(event$$10){};exportProperty(xdata.EventListener.prototype,"resolvedTransaction",xdata.EventListener.prototype.resolvedTransaction);
xdata.EventListener.prototype.executingCommand=function(event$$11){};exportProperty(xdata.EventListener.prototype,"executingCommand",xdata.EventListener.prototype.executingCommand);xdata.EventListener.prototype.executedCommand=function(event$$12){};exportProperty(xdata.EventListener.prototype,"executedCommand",xdata.EventListener.prototype.executedCommand);xdata.List=function(){};exportSymbol("xdata.List",xdata.List);xdata.List.prototype.getMetadata=function(){};exportProperty(xdata.List.prototype,"getMetadata",xdata.List.prototype.getMetadata);xdata.schema.Property=function(name$$48,config$$8,schema$$7){xdata.schema.Element.call(this,name$$48,config$$8,schema$$7)};extendConstructor(xdata.schema.Property,xdata.schema.Element);exportSymbol("xdata.schema.Property",xdata.schema.Property);xdata.schema.Attribute=function(name$$49,config$$9,schema$$8){var $jscomp$this$$17=this;xdata.schema.Property.call(this,name$$49,config$$9,schema$$8);if(!name$$49)throw new Error("No name specified");var typeHandler$$3=schema$$8.getTypeHandler(xdata.schema.Attribute._extractConfigType(config$$9));config$$9=xdata.schema.Attribute.normalizeConfig(config$$9,typeHandler$$3);this._type=xdata.schema.readValue(config$$9,"type","type");this._key=xdata.schema.readValue(config$$9,"key");this._fields=xdata.schema.readNamedElements(config$$9,
"typeMapping",xdata.schema.AttributeField,schema$$8,"field");this._fields.list.forEach(function(field$$12){return field$$12.initAttribute($jscomp$this$$17)});this._entity=null};extendConstructor(xdata.schema.Attribute,xdata.schema.Property);exportSymbol("xdata.schema.Attribute",xdata.schema.Attribute);
xdata.schema.Attribute._extractConfigType=function(config$$10){if(!config$$10)throw new Error("Missing configuration");var type$$71=typeof config$$10==="string"?config$$10:config$$10["type"];if(!type$$71)throw new Error("No type specified");return type$$71};
xdata.schema.Attribute.normalizeConfig=function(config$$11,typeHandler$$4){if(!config$$11)throw new Error("Missing configuration");if(typeof config$$11==="string")config$$11={"type":config$$11};var defaultTypeMapping=xdata.schema.Attribute._createTypeMapping(typeHandler$$4);var configTypeMapping;if(!config$$11.hasOwnProperty("typeMapping"))configTypeMapping=defaultTypeMapping;else if(typeof config$$11["typeMapping"]==="string")configTypeMapping={"":config$$11["typeMapping"]};else configTypeMapping=
xdata.util.assignObject({},config$$11["typeMapping"]);config$$11["typeMapping"]=configTypeMapping;xdata.util.forEachOfObject(defaultTypeMapping,function(fieldConfig,fieldName$$19){if(!configTypeMapping.hasOwnProperty(fieldName$$19))configTypeMapping[fieldName$$19]=fieldConfig});var configProvider=config$$11["provider"];xdata.util.forEachOfObject(configTypeMapping,function(fieldConfig$$1,fieldName$$20){if(!defaultTypeMapping.hasOwnProperty(fieldName$$20))throw new Error("Mapped type has no "+(fieldName$$20?
"'"+fieldName$$20+"'":"default")+" field");if(configProvider){configTypeMapping[fieldName$$20]=fieldConfig$$1=xdata.schema.AttributeField.normalizeConfig(fieldConfig$$1);fieldConfig$$1["provider"]=xdata.util.assignObject({},configProvider,fieldConfig$$1["provider"])}});if(!config$$11.hasOwnProperty("key"))config$$11["key"]=false;return config$$11};
xdata.schema.Attribute._createTypeMapping=function(typeHandler$$5){var mapping$$7=typeHandler$$5.getMapping();if(typeof mapping$$7==="string")mapping$$7={"":mapping$$7};return xdata.util.assignObject({},mapping$$7)};xdata.schema.Attribute.prototype.initEntity=function(entity$$10){if(this._entity)throw new Error("Entity already initialized");this._entity=entity$$10};xdata.schema.Attribute.prototype.getType=function(){return this._type};exportProperty(xdata.schema.Attribute.prototype,"getType",xdata.schema.Attribute.prototype.getType);
xdata.schema.Attribute.prototype.isKey=function(){return this._key};exportProperty(xdata.schema.Attribute.prototype,"isKey",xdata.schema.Attribute.prototype.isKey);xdata.schema.Attribute.prototype.getFields=function(){return this._fields.list};exportProperty(xdata.schema.Attribute.prototype,"getFields",xdata.schema.Attribute.prototype.getFields);xdata.schema.Attribute.prototype.hasField=function(name$$50){return!!this._fields.map[name$$50]};
exportProperty(xdata.schema.Attribute.prototype,"hasField",xdata.schema.Attribute.prototype.hasField);xdata.schema.Attribute.prototype.getField=function(name$$51){return xdata.schema.getExisting(this._fields.map,name$$51,"field")};exportProperty(xdata.schema.Attribute.prototype,"getField",xdata.schema.Attribute.prototype.getField);xdata.schema.Attribute.prototype.getEntity=function(){if(!this._entity)throw new Error("Not part of an entity");return this._entity};
exportProperty(xdata.schema.Attribute.prototype,"getEntity",xdata.schema.Attribute.prototype.getEntity);xdata.schema.AttributeField=function(name$$52,config$$12,schema$$9){xdata.schema.Element.call(this,name$$52,config$$12,schema$$9);config$$12=xdata.schema.AttributeField.normalizeConfig(config$$12);this._type=xdata.schema.readEnumValue(config$$12,"type",xdata.SimpleType,"type");this._attr=null};extendConstructor(xdata.schema.AttributeField,xdata.schema.Element);exportSymbol("xdata.schema.AttributeField",xdata.schema.AttributeField);
xdata.schema.AttributeField.normalizeConfig=function(config$$13){if(!config$$13)throw new Error("Missing configuration");if(typeof config$$13==="string")config$$13={"type":config$$13};return config$$13};xdata.schema.AttributeField.prototype.initAttribute=function(attr$$6){if(this._attr)throw new Error("Attribute already initialized");this._attr=attr$$6};xdata.schema.AttributeField.prototype.getType=function(){return this._type};exportProperty(xdata.schema.AttributeField.prototype,"getType",xdata.schema.AttributeField.prototype.getType);
xdata.schema.AttributeField.prototype.getAttribute=function(){if(!this._attr)throw new Error("Not part of an attribute");return this._attr};exportProperty(xdata.schema.AttributeField.prototype,"getAttribute",xdata.schema.AttributeField.prototype.getAttribute);xdata.schema.Cardinality={ONE:"1",MANY:"N"};xdata.schema.Entity=function(name$$53,config$$14,schema$$10){var $jscomp$this$$18=this;xdata.schema.Element.call(this,name$$53,config$$14,schema$$10);if(!name$$53)throw new Error("No name specified");config$$14=xdata.schema.Entity.normalizeConfig(config$$14);var attrs=xdata.schema.readNamedElements(config$$14,"attributes",xdata.schema.Attribute,schema$$10,"attribute");if(attrs.list.length<=0)throw new Error("No attributes defined");var keyAttr=null;attrs.list.forEach(function(attr$$7){if(config$$14["roles"].hasOwnProperty(attr$$7.getName()))throw new Error("Name '"+
attr$$7.getName()+"' conflict between attributes and roles");if(attr$$7.isKey())if(keyAttr)throw new Error("Multiple key attributes defined");else keyAttr=attr$$7});var indexes=xdata.schema.readNamedElements(config$$14,"indexes",xdata.schema.Index,schema$$10,"index");var inputs$$9=xdata.schema.readNamedElements(config$$14,"inputs",xdata.schema.Input,schema$$10,"input");attrs.list.forEach(function(attr$$8){return attr$$8.initEntity($jscomp$this$$18)});this._attrs=attrs;this._keyAttr=keyAttr;indexes.list.forEach(function(index$$37){return index$$37.initEntity($jscomp$this$$18)});
this._indexes=indexes;inputs$$9.list.forEach(function(input$$8){return input$$8.initEntity($jscomp$this$$18)});this._inputs=inputs$$9;this._roles={map:{},list:[]};this._rels=null;xdata.util.forEachOfObject(config$$14["roles"]||{},function(roleRef,roleLocalName){var m=/^([^\s\.]+)\.([^\s\.]+)$/.exec(roleRef);if(!m)throw new Error("Invalid role reference '"+roleRef+"'");var rel$$3=schema$$10.getRelationship(m[1]);var role$$3=rel$$3.getRole(m[2]);try{role$$3.initEntity($jscomp$this$$18,roleLocalName)}catch(e$$3){throw new Error("Role '"+
roleRef+"' already connected to another entity");}$jscomp$this$$18._roles.map[roleLocalName]=role$$3;$jscomp$this$$18._roles.list.push(role$$3)});this._props={map:xdata.util.assignObject({},this._attrs.map,this._roles.map),list:this._attrs.list.concat(this._roles.list)}};extendConstructor(xdata.schema.Entity,xdata.schema.Element);exportSymbol("xdata.schema.Entity",xdata.schema.Entity);
xdata.schema.Entity.normalizeConfig=function(config$$15){if(!config$$15)throw new Error("Missing configuration");if(!config$$15.hasOwnProperty("attributes"))config$$15["attributes"]={};if(!config$$15.hasOwnProperty("indexes"))config$$15["indexes"]={};if(Array.isArray(config$$15["indexes"])){var namedConfigIndexes={};config$$15["indexes"].forEach(function(indexConfig,index$$38){var indexAttributesConfig=typeof indexConfig==="string"||Array.isArray(indexConfig)?indexConfig:indexConfig["attributes"];
var name$$54=typeof indexAttributesConfig==="string"?indexAttributesConfig:indexAttributesConfig.join("_");namedConfigIndexes[name$$54]=indexConfig});config$$15["indexes"]=namedConfigIndexes}if(!config$$15.hasOwnProperty("inputs"))config$$15["inputs"]={};if(!config$$15.hasOwnProperty("roles"))config$$15["roles"]={};return config$$15};xdata.schema.Entity.prototype.getAttributes=function(){return this._attrs.list};exportProperty(xdata.schema.Entity.prototype,"getAttributes",xdata.schema.Entity.prototype.getAttributes);
xdata.schema.Entity.prototype.hasAttribute=function(name$$55){return!!this._attrs.map[name$$55]};exportProperty(xdata.schema.Entity.prototype,"hasAttribute",xdata.schema.Entity.prototype.hasAttribute);xdata.schema.Entity.prototype.getAttribute=function(name$$56){return xdata.schema.getExisting(this._attrs.map,name$$56,"attribute")};exportProperty(xdata.schema.Entity.prototype,"getAttribute",xdata.schema.Entity.prototype.getAttribute);xdata.schema.Entity.prototype.hasKeyAttribute=function(){return!!this._keyAttr};
exportProperty(xdata.schema.Entity.prototype,"hasKeyAttribute",xdata.schema.Entity.prototype.hasKeyAttribute);xdata.schema.Entity.prototype.getKeyAttribute=function(){if(this._keyAttr)return this._keyAttr;throw new Error("Entity has no key attribute");};exportProperty(xdata.schema.Entity.prototype,"getKeyAttribute",xdata.schema.Entity.prototype.getKeyAttribute);xdata.schema.Entity.prototype.getIndexes=function(){return this._indexes.list};
exportProperty(xdata.schema.Entity.prototype,"getIndexes",xdata.schema.Entity.prototype.getIndexes);xdata.schema.Entity.prototype.hasIndex=function(name$$57){return!!this._indexes.map[name$$57]};exportProperty(xdata.schema.Entity.prototype,"hasIndex",xdata.schema.Entity.prototype.hasIndex);xdata.schema.Entity.prototype.getIndex=function(name$$58){return xdata.schema.getExisting(this._indexes.map,name$$58,"index")};exportProperty(xdata.schema.Entity.prototype,"getIndex",xdata.schema.Entity.prototype.getIndex);
xdata.schema.Entity.prototype.getInputs=function(){return this._inputs.list};exportProperty(xdata.schema.Entity.prototype,"getInputs",xdata.schema.Entity.prototype.getInputs);xdata.schema.Entity.prototype.hasInput=function(name$$59){return!!this._inputs.map[name$$59]};exportProperty(xdata.schema.Entity.prototype,"hasInput",xdata.schema.Entity.prototype.hasInput);xdata.schema.Entity.prototype.getInput=function(name$$60){return xdata.schema.getExisting(this._inputs.map,name$$60,"input")};
exportProperty(xdata.schema.Entity.prototype,"getInput",xdata.schema.Entity.prototype.getInput);xdata.schema.Entity.prototype.getRoles=function(){return this._roles.list};exportProperty(xdata.schema.Entity.prototype,"getRoles",xdata.schema.Entity.prototype.getRoles);xdata.schema.Entity.prototype.hasRole=function(name$$61){return!!this._roles.map[name$$61]};exportProperty(xdata.schema.Entity.prototype,"hasRole",xdata.schema.Entity.prototype.hasRole);
xdata.schema.Entity.prototype.getRole=function(name$$62){return xdata.schema.getExisting(this._roles.map,name$$62,"role")};exportProperty(xdata.schema.Entity.prototype,"getRole",xdata.schema.Entity.prototype.getRole);
xdata.schema.Entity.prototype.getRelationships=function(){var rels=this._rels;if(rels)return rels;var relsSet={};rels=[];this.getRoles().forEach(function(role$$4){var rel$$4=role$$4.getRelationship();var relName=rel$$4.getName();if(relsSet[relName]===true)return;relsSet[relName]=true;rels.push(rel$$4)});this._rels=rels;return rels};exportProperty(xdata.schema.Entity.prototype,"getRelationships",xdata.schema.Entity.prototype.getRelationships);xdata.schema.Entity.prototype.getProperties=function(){return this._props.list};
exportProperty(xdata.schema.Entity.prototype,"getProperties",xdata.schema.Entity.prototype.getProperties);xdata.schema.Entity.prototype.hasProperty=function(name$$63){return!!this._props.map[name$$63]};exportProperty(xdata.schema.Entity.prototype,"hasProperty",xdata.schema.Entity.prototype.hasProperty);xdata.schema.Entity.prototype.getProperty=function(name$$64){return xdata.schema.getExisting(this._props.map,name$$64,"property")};exportProperty(xdata.schema.Entity.prototype,"getProperty",xdata.schema.Entity.prototype.getProperty);xdata.schema.Index=function(name$$65,config$$16,schema$$11){xdata.schema.Element.call(this,name$$65,config$$16,schema$$11);config$$16=xdata.schema.Index.normalizeConfig(config$$16);var attrNames=config$$16["attributes"].slice();if(attrNames.length<=0)throw new Error("No attributes specified");this._unique=xdata.schema.readValue(config$$16,"unique");this._attrNames=attrNames;this._entity=null;this._attrs=null};extendConstructor(xdata.schema.Index,xdata.schema.Element);
exportSymbol("xdata.schema.Index",xdata.schema.Index);xdata.schema.Index.normalizeConfig=function(config$$17){if(!config$$17)throw new Error("Missing configuration");if(typeof config$$17==="string"||Array.isArray(config$$17))config$$17={"attributes":config$$17};if(typeof config$$17["attributes"]==="string")config$$17["attributes"]=[config$$17["attributes"]];if(!config$$17.hasOwnProperty("unique"))config$$17["unique"]=false;return config$$17};
xdata.schema.Index.prototype.initEntity=function(entity$$11){if(this._entity||this._attrs)throw new Error("Entity already initialized");this._entity=entity$$11;this._attrs=this._attrNames.map(function(attrName$$3){return entity$$11.getAttribute(attrName$$3)},this)};xdata.schema.Index.prototype.isUnique=function(){return this._unique};exportProperty(xdata.schema.Index.prototype,"isUnique",xdata.schema.Index.prototype.isUnique);
xdata.schema.Index.prototype.getEntity=function(){if(!this._entity)throw new Error("Not part of an entity");return this._entity};exportProperty(xdata.schema.Index.prototype,"getEntity",xdata.schema.Index.prototype.getEntity);xdata.schema.Index.prototype.getAttributes=function(){if(!this._attrs)throw new Error("Not part of an entity");return this._attrs};exportProperty(xdata.schema.Index.prototype,"getAttributes",xdata.schema.Index.prototype.getAttributes);xdata.schema.Input=function(name$$66,config$$18,schema$$12){var $jscomp$this$$19=this;xdata.schema.Element.call(this,name$$66,config$$18,schema$$12);if(!name$$66)throw new Error("No name specified");var typeHandler$$6=schema$$12.getTypeHandler(xdata.schema.Input._extractConfigType(config$$18));config$$18=xdata.schema.Input.normalizeConfig(config$$18,typeHandler$$6);this._type=xdata.schema.readValue(config$$18,"type","type");this._fields=xdata.schema.readNamedElements(config$$18,"typeMapping",xdata.schema.InputField,
schema$$12,"field");this._fields.list.forEach(function(field$$13){return field$$13.initInput($jscomp$this$$19)});this._entity=null};extendConstructor(xdata.schema.Input,xdata.schema.Element);exportSymbol("xdata.schema.Input",xdata.schema.Input);xdata.schema.Input._extractConfigType=function(config$$19){if(!config$$19)throw new Error("Missing configuration");var type$$72=typeof config$$19==="string"?config$$19:config$$19["type"];if(!type$$72)throw new Error("No type specified");return type$$72};
xdata.schema.Input.normalizeConfig=function(config$$20,typeHandler$$7){if(!config$$20)throw new Error("Missing configuration");if(typeof config$$20==="string")config$$20={"type":config$$20};var defaultTypeMapping$$1=xdata.schema.Input._createTypeMapping(typeHandler$$7);var configTypeMapping$$1;if(!config$$20.hasOwnProperty("typeMapping"))configTypeMapping$$1=defaultTypeMapping$$1;else if(typeof config$$20["typeMapping"]==="string")configTypeMapping$$1={"":config$$20["typeMapping"]};else configTypeMapping$$1=
xdata.util.assignObject({},config$$20["typeMapping"]);config$$20["typeMapping"]=configTypeMapping$$1;xdata.util.forEachOfObject(defaultTypeMapping$$1,function(fieldConfig$$2,fieldName$$21){if(!configTypeMapping$$1.hasOwnProperty(fieldName$$21))configTypeMapping$$1[fieldName$$21]=fieldConfig$$2});var configProvider$$1=config$$20["provider"];xdata.util.forEachOfObject(configTypeMapping$$1,function(fieldConfig$$3,fieldName$$22){if(!defaultTypeMapping$$1.hasOwnProperty(fieldName$$22))throw new Error("Mapped type has no "+
(fieldName$$22?"'"+fieldName$$22+"'":"default")+" field");if(configProvider$$1){configTypeMapping$$1[fieldName$$22]=fieldConfig$$3=xdata.schema.InputField.normalizeConfig(fieldConfig$$3);fieldConfig$$3["provider"]=xdata.util.assignObject({},configProvider$$1,fieldConfig$$3["provider"])}});return config$$20};
xdata.schema.Input._createTypeMapping=function(typeHandler$$8){var mapping$$8=typeHandler$$8.getMapping();if(typeof mapping$$8==="string")mapping$$8={"":mapping$$8};return xdata.util.assignObject({},mapping$$8)};xdata.schema.Input.prototype.initEntity=function(entity$$12){if(this._entity)throw new Error("Entity already initialized");this._entity=entity$$12};xdata.schema.Input.prototype.getType=function(){return this._type};exportProperty(xdata.schema.Input.prototype,"getType",xdata.schema.Input.prototype.getType);
xdata.schema.Input.prototype.getFields=function(){return this._fields.list};exportProperty(xdata.schema.Input.prototype,"getFields",xdata.schema.Input.prototype.getFields);xdata.schema.Input.prototype.hasField=function(name$$67){return!!this._fields.map[name$$67]};exportProperty(xdata.schema.Input.prototype,"hasField",xdata.schema.Input.prototype.hasField);xdata.schema.Input.prototype.getField=function(name$$68){return xdata.schema.getExisting(this._fields.map,name$$68,"field")};
exportProperty(xdata.schema.Input.prototype,"getField",xdata.schema.Input.prototype.getField);xdata.schema.Input.prototype.getEntity=function(){if(!this._entity)throw new Error("Not part of an entity");return this._entity};exportProperty(xdata.schema.Input.prototype,"getEntity",xdata.schema.Input.prototype.getEntity);xdata.schema.InputField=function(name$$69,config$$21,schema$$13){xdata.schema.Element.call(this,name$$69,config$$21,schema$$13);config$$21=xdata.schema.InputField.normalizeConfig(config$$21);this._type=xdata.schema.readEnumValue(config$$21,"type",xdata.SimpleType,"type");this._input=null};extendConstructor(xdata.schema.InputField,xdata.schema.Element);exportSymbol("xdata.schema.InputField",xdata.schema.InputField);
xdata.schema.InputField.normalizeConfig=function(config$$22){if(!config$$22)throw new Error("Missing configuration");if(typeof config$$22==="string")config$$22={"type":config$$22};return config$$22};xdata.schema.InputField.prototype.initInput=function(input$$9){if(this._input)throw new Error("Input already initialized");this._input=input$$9};xdata.schema.InputField.prototype.getType=function(){return this._type};exportProperty(xdata.schema.InputField.prototype,"getType",xdata.schema.InputField.prototype.getType);
xdata.schema.InputField.prototype.getInput=function(){if(!this._input)throw new Error("Not part of an input");return this._input};exportProperty(xdata.schema.InputField.prototype,"getInput",xdata.schema.InputField.prototype.getInput);xdata.schema.Relationship=function(name$$70,config$$23,schema$$14){xdata.schema.Element.call(this,name$$70,config$$23,schema$$14);if(!name$$70)throw new Error("No name specified");config$$23=xdata.schema.Relationship.normalizeConfig(config$$23);var roles=xdata.schema.readNamedElements(config$$23,"roles",xdata.schema.Role,schema$$14,"role");if(roles.list.length!==2){if(roles.list.length<=0)throw new Error("No roles defined");else if(roles.list.length<2)throw new Error("Only one role defined");throw new Error("More than two roles defined");
}roles.list.forEach(function(role$$5){role$$5.initRelationship(this)},this);this._rolesMap=roles.map;this._role1=roles.list[0];this._role2=roles.list[1];this._self=null;this._entitiesMap=null};extendConstructor(xdata.schema.Relationship,xdata.schema.Element);exportSymbol("xdata.schema.Relationship",xdata.schema.Relationship);
xdata.schema.Relationship.normalizeConfig=function(config$$24){if(!config$$24)throw new Error("Missing configuration");if(Array.isArray(config$$24))config$$24={"roles":config$$24};if(Array.isArray(config$$24["roles"])){var namedConfigRoles={};config$$24["roles"].forEach(function(roleConfig,index$$39){namedConfigRoles[String(index$$39+1)]=roleConfig});config$$24["roles"]=namedConfigRoles}return config$$24};
xdata.schema.Relationship.prototype.computeInverseRole=function(role$$6){if(DEBUG)if(role$$6!==this._role1&&role$$6!==this._role2)throw new Error("Not a role of this relationship");return role$$6===this._role1?this._role2:this._role1};xdata.schema.Relationship.prototype.getRole1=function(){return this._role1};exportProperty(xdata.schema.Relationship.prototype,"getRole1",xdata.schema.Relationship.prototype.getRole1);xdata.schema.Relationship.prototype.getRole2=function(){return this._role2};
exportProperty(xdata.schema.Relationship.prototype,"getRole2",xdata.schema.Relationship.prototype.getRole2);xdata.schema.Relationship.prototype.hasRole=function(name$$71){return!!this._rolesMap[name$$71]};exportProperty(xdata.schema.Relationship.prototype,"hasRole",xdata.schema.Relationship.prototype.hasRole);xdata.schema.Relationship.prototype.getRole=function(name$$72){return xdata.schema.getExisting(this._rolesMap,name$$72,"role")};exportProperty(xdata.schema.Relationship.prototype,"getRole",xdata.schema.Relationship.prototype.getRole);
xdata.schema.Relationship.prototype.getEntity1=function(){return this._role1.getEntity()};exportProperty(xdata.schema.Relationship.prototype,"getEntity1",xdata.schema.Relationship.prototype.getEntity1);xdata.schema.Relationship.prototype.getEntity2=function(){return this._role2.getEntity()};exportProperty(xdata.schema.Relationship.prototype,"getEntity2",xdata.schema.Relationship.prototype.getEntity2);
xdata.schema.Relationship.prototype.hasEntity=function(name$$73){if(!!this._getEntitiesMap()[name$$73]){if(this._isSelf())throw new Error("Ambiguous entity reference from self-relationship");return true}return false};exportProperty(xdata.schema.Relationship.prototype,"hasEntity",xdata.schema.Relationship.prototype.hasEntity);
xdata.schema.Relationship.prototype.getEntity=function(name$$74){var entity$$13=xdata.schema.getExisting(this._getEntitiesMap(),name$$74,"entity");if(this._isSelf())throw new Error("Ambiguous entity reference from self-relationship");return entity$$13};exportProperty(xdata.schema.Relationship.prototype,"getEntity",xdata.schema.Relationship.prototype.getEntity);
xdata.schema.Relationship.prototype._getEntitiesMap=function(){var entitiesMap=this._entitiesMap;if(!entitiesMap){entitiesMap={};entitiesMap[this.getEntity1()]=this.getEntity1();entitiesMap[this.getEntity2()]=this.getEntity2();this._entitiesMap=entitiesMap}return entitiesMap};xdata.schema.Relationship.prototype._isSelf=function(){if(this._self===null)this._self=this.getEntity1()===this.getEntity2();return this._self};xdata.schema.Role=function(name$$75,config$$25,schema$$15){xdata.schema.Property.call(this,name$$75,config$$25,schema$$15);if(!name$$75)throw new Error("No name specified");config$$25=xdata.schema.Role.normalizeConfig(config$$25);this._cardinality=xdata.schema.readEnumValue(config$$25,"cardinality",xdata.schema.Cardinality,"cardinality");this._rel=null;this._inverse=null;this._entity=null;this._nameAtEntity=null};extendConstructor(xdata.schema.Role,xdata.schema.Property);
exportSymbol("xdata.schema.Role",xdata.schema.Role);xdata.schema.Role.normalizeConfig=function(config$$26){if(!config$$26)throw new Error("Missing configuration");if(typeof config$$26==="string")config$$26={"cardinality":config$$26};return config$$26};xdata.schema.Role.prototype.initRelationship=function(rel$$5){if(this._rel)throw new Error("Relationship already initialized");this._rel=rel$$5};
xdata.schema.Role.prototype.initEntity=function(entity$$14,nameAtEntity){if(this._entity)throw new Error("Entity already initialized");this._entity=entity$$14;this._nameAtEntity=nameAtEntity};xdata.schema.Role.prototype.isOneParticipant=function(){return this._cardinality===xdata.schema.Cardinality.ONE};exportProperty(xdata.schema.Role.prototype,"isOneParticipant",xdata.schema.Role.prototype.isOneParticipant);xdata.schema.Role.prototype.isManyParticipant=function(){return this._cardinality===xdata.schema.Cardinality.MANY};
exportProperty(xdata.schema.Role.prototype,"isManyParticipant",xdata.schema.Role.prototype.isManyParticipant);xdata.schema.Role.prototype.getRelationship=function(){if(!this._rel)throw new Error("Not part of a relationship");return this._rel};exportProperty(xdata.schema.Role.prototype,"getRelationship",xdata.schema.Role.prototype.getRelationship);xdata.schema.Role.prototype.getInverseRole=function(){if(!this._inverse)this._inverse=this.getRelationship().computeInverseRole(this);return this._inverse};
exportProperty(xdata.schema.Role.prototype,"getInverseRole",xdata.schema.Role.prototype.getInverseRole);xdata.schema.Role.prototype.isOneValue=function(){return this.getInverseRole().isOneParticipant()};exportProperty(xdata.schema.Role.prototype,"isOneValue",xdata.schema.Role.prototype.isOneValue);xdata.schema.Role.prototype.isManyValue=function(){return this.getInverseRole().isManyParticipant()};exportProperty(xdata.schema.Role.prototype,"isManyValue",xdata.schema.Role.prototype.isManyValue);
xdata.schema.Role.prototype.getEntity=function(){if(!this._entity)throw new Error("Not connected to an entity");return this._entity};exportProperty(xdata.schema.Role.prototype,"getEntity",xdata.schema.Role.prototype.getEntity);xdata.schema.Role.prototype.getNameAtEntity=function(){if(!this._nameAtEntity)throw new Error("Not connected to an entity");return this._nameAtEntity};exportProperty(xdata.schema.Role.prototype,"getNameAtEntity",xdata.schema.Role.prototype.getNameAtEntity);
xdata.schema.Role.prototype.getInverseEntity=function(){return this.getInverseRole().getEntity()};exportProperty(xdata.schema.Role.prototype,"getInverseEntity",xdata.schema.Role.prototype.getInverseEntity);xdata.ValueOperator={EMPTY:"empty",NOT_EMPTY:"!empty",NULL:"null",NOT_NULL:"!null",IN:"in",NOT_IN:"!in",EQUAL:"\x3d\x3d",EQUAL_IGNORE_CASE:"\x3d\x3d~",NOT_EQUAL:"!\x3d",NOT_EQUAL_IGNORE_CASE:"!\x3d~",GREATER:"\x3e",GREATER_OR_EQUAL:"\x3e\x3d",LESSER:"\x3c",LESSER_OR_EQUAL:"\x3c\x3d",BEGINNING:"beginning",BEGINNING_IGNORE_CASE:"beginning~",NOT_BEGINNING:"!beginning",NOT_BEGINNING_IGNORE_CASE:"!beginning~",CONTAINING:"containing",CONTAINING_IGNORE_CASE:"containing~",NOT_CONTAINING:"!containing",NOT_CONTAINING_IGNORE_CASE:"!containing~",
ENDING:"ending",ENDING_IGNORE_CASE:"ending~",NOT_ENDING:"!ending",NOT_ENDING_IGNORE_CASE:"!ending~"};exportSymbol("xdata.ValueOperator",xdata.ValueOperator);xdata.ValueOperator._UNARY=function(){var map$$2={};map$$2[xdata.ValueOperator.EMPTY]=true;map$$2[xdata.ValueOperator.NOT_EMPTY]=true;map$$2[xdata.ValueOperator.NULL]=true;map$$2[xdata.ValueOperator.NOT_NULL]=true;return map$$2}();xdata.ValueOperator.isUnary=function(operator$$6){return xdata.ValueOperator._UNARY[operator$$6]===true};
xdata.ValueOperator.isBinary=function(operator$$7){return xdata.ValueOperator._UNARY[operator$$7]!==true};xdata.VersionError=makeCustomErrorConstructor("xdata.VersionError",undefined,function(expectedVersion,actualVersion){this._super("Version mismatch: expected "+expectedVersion+", but was "+actualVersion);this.expectedVersion=expectedVersion;this.actualVersion=actualVersion});exportSymbol("xdata.VersionError",xdata.VersionError);xdata.registerProvider=function(name$$76,constructor$$1){xdata.core.DatabaseImpl.registerProviderConstructor(name$$76,constructor$$1)};exportSymbol("xdata.registerProvider",xdata.registerProvider);xdata.registerTypeHandler=function(type$$73,handler$$7){xdata.core.TypeHandlers.register(type$$73,handler$$7)};exportSymbol("xdata.registerTypeHandler",xdata.registerTypeHandler);
xdata.createDatabase=function(providerName$$4,providerConfig$$2,version$$9,schema$$16){schema$$16=xdata.schema.Schema.normalize(schema$$16);return new xdata.core.DatabaseImpl(providerName$$4,providerConfig$$2,version$$9,schema$$16)};exportSymbol("xdata.createDatabase",xdata.createDatabase);})();})(this);